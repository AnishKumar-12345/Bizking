import{_ as I,o as n,c,g as t,w as s,i as f,j as y,k,l as b,m as _,b as g,a as r,b8 as V,F as p,q as v,t as o,u as x,bo as L,bp as N,bq as B,v as F,e as U,s as Q,r as E,f as O}from"./index.1e74d771.js";import{s as G}from"./Services.fc64c8f6.js";import{V as S}from"./VForm.71d58806.js";import{V as T}from"./VAutocomplete.619e07ce.js";import{V as w}from"./VTextField.885cdaf5.js";import{V as C}from"./VTable.0d03150f.js";import{V as A}from"./VDialog.e7545b58.js";import{V as q}from"./VPagination.f3dd4ba9.js";import{V as R}from"./VSnackbar.77d80dca.js";import{V as H,a as M,b as W,c as j}from"./VWindowItem.e7e87b5e.js";import"./VCounter.43796278.js";import"./VSelect.5d5c13a6.js";import"./VCheckboxBtn.f0a6d4c7.js";import"./VChip.6a917441.js";const K={mixins:[G],data(){return{expandedIndex:null,snackbar:!1,snackbarText:"",timeout:6e3,color:"",top:!1,bottom:!0,left:!1,right:!1,Enddate:"",locationdata:"",cityID:"",loading:"",cityLoaction:[],getAllsalesorderdata:[],person:[a=>!!a||"Assign Delivery Person is required"],headers:[{text:"Serial No.",value:"user_name"},{text:"City",value:"user_name"},{text:"Trip Name",value:"user_name"},{text:"Location",value:"merchant_uid"},{text:"Driver Name",value:"target_amount"},{text:"Sales Order Count",value:"achieved_target"},{text:"Action",value:"achieved_percentage"}],headers3:[{text:"So No.",value:"so_no"},{text:"Created Date",value:"so_no"},{text:"Merchant UID",value:"merchant_name"},{text:"Status",value:"status"},{text:"Invoice Number",value:"user_name"},{text:"Not Deliver Reason",value:"user_name"},{text:"Invoice File",value:"user_name"},{text:"Delivery Challan File",value:"user_name"},{text:"Action",value:"achieved_percentage"}],headers2:[{text:"Serial No.",value:"user_name"},{text:"SKU Name",value:"user_name"},{text:"Shipped Ordered",value:"user_name"},{text:"Shipped Exchange",value:"user_name"}],AssignedPerson:[],deliveryPerson:[],Deliverypersondata:"",TripId:"",searchQuery:"",page:1,pageSize:10,page2:1,pageSize2:10,dialog:!1,getSalesorder:[],dialog2:!1,searchQuery2:""}},computed:{filteredSAwisetarget(){const a=this.searchQuery.toLowerCase().trim();return this.AssignedPerson.filter(e=>e.city&&e.city.toLowerCase().includes(a)||e.delivery_person&&e.delivery_person.toLowerCase().includes(a)||e.location&&e.location.toLowerCase().includes(a)||e.sales_order_count&&e.sales_order_count.toString().includes(a)||e.trip_name&&e.trip_name.toLowerCase().includes(a))},paginatedItems(){const a=(this.page-1)*this.pageSize,e=a+this.pageSize;return this.filteredSAwisetarget.slice(a,e)},filteredSAwisetarget2(){const a=this.searchQuery2.toLowerCase().trim();return this.getSalesorder.filter(e=>e.shipped_exchange&&e.shipped_exchange.toString().includes(a)||e.shipped_ordered&&e.shipped_ordered.toString().includes(a)||e.sku_name&&e.sku_name.toLowerCase().includes(a))},paginatedItems2(){const a=(this.page2-1)*this.pageSize2,e=a+this.pageSize2;return this.filteredSAwisetarget2.slice(a,e)}},mounted(){this.cityID=localStorage.getItem("city_id"),this.handleBrandSelection()},methods:{getdeliverychallan(a){window.open(a,"_blank")},getinvoice(a){window.open(a,"_blank")},toggleExpand(a,e){this.expandedIndex=this.expandedIndex===e?null:e,this.GetTripsalesorders(a.trip_id).then(m=>{console.log("check the response",m),m.data.status==1?(this.getAllsalesorderdata=m.data.data,this.snackbar=!0,this.color="primary",this.snackbarText=m.data.message):(this.snackbar=!0,this.color="on-background",this.snackbarText=m.data.message)})},viewrow(a){this.GetTripdetails(a.trip_id).then(e=>{console.log("response",e),e.data.status==1?(this.getSalesorder=e.data.data,this.dialog2=!0,this.snackbar=!0,this.color="primary",this.snackbarText=e.data.message):(this.getSalesorder=[],this.dialog2=!1,this.snackbar=!0,this.color="on-background",this.snackbarText=e.data.message)})},closeDialog(){this.dialog=!1,this.Deliverypersondata=""},closeDialog2(){this.dialog2=!1},editrow(a){this.TripId=a.trip_id,this.Getsalesperson(this.cityID,this.locationdata).then(e=>{e.data.status==1?(this.deliveryPerson=e.data.data.map(m=>({value:m.delivery_person,text:m.name})),this.dialog=!0):(this.deliveryPerson=[],this.dialog=!1)})},validateForm2(){this.$refs.purchaseOrderForm.validate().then(a=>{a.valid==!0?this.Assigndelperson():(this.snackbar=!0,this.snackbarText="Please give all mandatory fields",this.color="on-background")})},Assigndelperson(){const a={trip_id:this.TripId,delivery_person:this.Deliverypersondata};this.Assigndeliveryperson(a).then(e=>{e.data.status==1?(this.dialog=!1,this.snackbar=!0,this.loading=!1,this.color="primary",this.snackbarText=e.data.message,this.validateForm(),this.Deliverypersondata="",this.TripId=""):(this.snackbar=!0,this.color="on-background",this.dialog=!1,this.snackbarText=e.data.message)})},updatePagination(a){this.page=a},updatePagination2(a){this.page2=a},validateForm(){this.$refs.tripform.validate().then(a=>{a.valid==!0?this.getAssignedview():(this.snackbar=!0,this.snackbarText="Please give all mandatory fields",this.color="on-background")})},getAssignedview(){this.loading=!0,this.Assignedpersondata(this.locationdata,this.Enddate).then(a=>{a.data.status==1?(this.AssignedPerson=a.data.data,this.snackbar=!0,this.loading=!1,this.color="primary",this.snackbarText=a.data.message):(this.loading=!1,this.snackbar=!0,this.color="on-background",this.AssignedPerson=[],this.snackbarText=a.data.message)})},handleBrandSelection(){this.getCitylocation(this.cityID).then(a=>{this.cityLoaction=a.data.data.map(e=>({value:e.location_id,text:e.location}))})}}},J={style:{"max-width":"400px"}},X={key:0,id:"app"},Y=N('<div id="loading-bg"><div class="loading-logo"><img src="'+B+'" height="60" width="68" alt="Logo"></div><div class="loading"><div class="effect-1 effects"></div><div class="effect-2 effects"></div><div class="effect-3 effects"></div></div></div>',1),Z=[Y],$={key:0},ee=r("td",{colspan:"16",class:"text-center"},[r("h1",null,"No data found !")],-1),te=[ee],ae={class:"text-center"},se={class:"text-center"},le={class:"text-center"},ie={class:"text-center"},re={class:"text-center"},oe={class:"text-center"},ne={class:"text-center"},de={colspan:"7"},ce={class:"text-center"},ue={class:"text-center"},he={class:"text-center"},me={class:"text-center"},_e={class:"text-center"},ge={class:"text-center"},pe={class:"text-center"},fe={class:"text-center"},ve={class:"text-center"},xe={style:{"max-width":"400px"}},be={class:"text-center"},ye={class:"text-center"},ke={class:"text-center"},Ve={class:"text-center"},we=r("br",null,null,-1);function Ce(a,e,m,D,l,u){return n(),c("div",null,[t(b,null,{default:s(()=>[t(f,{cols:"12"},{default:s(()=>[t(y,{title:"Assign Trip View",class:"mb-4"},{default:s(()=>[t(k,null,{default:s(()=>[t(S,{ref:"tripform",class:"mt-6"},{default:s(()=>[t(b,null,{default:s(()=>[t(f,{cols:"12",md:"6"},{default:s(()=>[t(T,{modelValue:l.locationdata,"onUpdate:modelValue":e[0]||(e[0]=i=>l.locationdata=i),label:"Location",items:l.cityLoaction,"item-value":"value","item-title":"text","menu-props":{maxHeight:200}},null,8,["modelValue","items"])]),_:1}),t(f,{cols:"12",md:"6"},{default:s(()=>[t(w,{modelValue:l.Enddate,"onUpdate:modelValue":e[1]||(e[1]=i=>l.Enddate=i),type:"date",label:"Date",rules:a.endr},null,8,["modelValue","rules"])]),_:1}),t(f,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:s(()=>[t(_,{onClick:u.validateForm},{default:s(()=>[g(" Get ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1}),r("div",J,[t(w,{modelValue:l.searchQuery,"onUpdate:modelValue":e[2]||(e[2]=i=>l.searchQuery=i),class:"mb-3",density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])]),l.loading?(n(),c("div",X,Z)):V("",!0),t(C,{headers:l.headers,items:u.paginatedItems,"item-key":"dessert",class:"table-rounded",height:"500","fixed-header":""},{default:s(()=>[r("thead",null,[r("tr",null,[(n(!0),c(p,null,v(l.headers,i=>(n(),c("th",{key:i,class:"text-center"},o(i.text),1))),128))])]),r("tbody",null,[u.filteredSAwisetarget.length===0?(n(),c("tr",$,te)):V("",!0),(n(!0),c(p,null,v(u.filteredSAwisetarget,(i,d)=>(n(),c(p,{key:d},[r("tr",null,[r("td",ae,o(d+1),1),r("td",se,o(i.city),1),r("td",le,o(i.trip_name),1),r("td",ie,o(i.location),1),r("td",re,o(i.delivery_person),1),r("td",oe,o(i.sales_order_count),1),r("td",ne,[t(_,{icon:"",variant:"text",color:"default",class:"mb-1 mt-2",size:"x-small",onClick:h=>u.toggleExpand(i,d)},{default:s(()=>[t(x,{icon:l.expandedIndex===d?"mdi-minus":"mdi-plus",size:"22",color:"#BA8B32"},null,8,["icon"])]),_:2},1032,["onClick"]),t(_,{icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:h=>u.editrow(i)},{default:s(()=>[t(x,{icon:"ri-pencil-line",size:"22",color:"#BA8B32"})]),_:2},1032,["onClick"]),t(_,{icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:h=>u.viewrow(i)},{default:s(()=>[t(x,{color:"success",icon:"basil:eye-outline",size:"22"})]),_:2},1032,["onClick"])])]),l.expandedIndex===d?(n(),c("tr",{key:`expanded-${d}`},[r("td",de,[t(L,null,{default:s(()=>[r("div",null,[t(C,{dense:""},{default:s(()=>[r("thead",null,[r("tr",null,[(n(!0),c(p,null,v(l.headers3,h=>(n(),c("th",{key:h,class:"text-center"},o(h.text),1))),128))])]),r("tbody",null,[(n(!0),c(p,null,v(l.getAllsalesorderdata,(h,z)=>(n(),c("tr",{key:z},[r("td",ce,o(h.so_number),1),r("td",ue,o(h.created_date),1),r("td",he,o(h.merchant_uid),1),r("td",me,o(h.so_status),1),r("td",_e,o(h.invoice_number),1),r("td",ge,o(h.not_delivered_reason),1),r("td",pe,[t(_,{icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:P=>u.getinvoice(h.invoice_file)},{default:s(()=>[t(x,{color:"error",icon:"iwwa:file-pdf",size:"26"})]),_:2},1032,["onClick"])]),r("td",fe,[t(_,{icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:P=>u.getdeliverychallan(h.delivery_challan_file)},{default:s(()=>[t(x,{color:"error",icon:"iwwa:file-pdf",size:"26"})]),_:2},1032,["onClick"])]),r("td",ve,[t(_,{icon:"",variant:"text",color:"default",class:"me-2",size:"x-small"},{default:s(()=>[t(x,{icon:"ri-pencil-line",size:"22",color:"#BA8B32"})]),_:1})])]))),128))])]),_:2},1024)])]),_:2},1024)])])):V("",!0)],64))),128))]),t(A,{modelValue:l.dialog,"onUpdate:modelValue":e[4]||(e[4]=i=>l.dialog=i),"max-width":"400",persistent:""},{default:s(()=>[t(y,{title:"Assign Delivery Person",class:"mb-2"},{default:s(()=>[t(k,null,{default:s(()=>[t(b,null,{default:s(()=>[t(f,{cols:"12"},{default:s(()=>[t(S,{ref:"purchaseOrderForm",class:"mt-4"},{default:s(()=>[t(b,null,{default:s(()=>[t(f,{md:"12",cols:"12"},{default:s(()=>[t(T,{modelValue:l.Deliverypersondata,"onUpdate:modelValue":e[3]||(e[3]=i=>l.Deliverypersondata=i),items:l.deliveryPerson,"item-value":"value","item-title":"text",label:"Assign Delivery Person",rules:l.person,"menu-props":{maxHeight:200}},null,8,["modelValue","items","rules"])]),_:1}),t(f,{md:"12",cols:"12"},{default:s(()=>[t(_,{onClick:u.validateForm2},{default:s(()=>[g(" Save ")]),_:1},8,["onClick"]),g(" \xA0 "),t(_,{color:"secondary",variant:"tonal",onClick:u.closeDialog},{default:s(()=>[g(" Close ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(A,{modelValue:l.dialog2,"onUpdate:modelValue":e[6]||(e[6]=i=>l.dialog2=i),"max-width":"800"},{default:s(()=>[t(y,{title:"View Trip Sales Orders",class:"mb-2"},{default:s(()=>[t(k,null,{default:s(()=>[r("div",xe,[t(w,{modelValue:l.searchQuery2,"onUpdate:modelValue":e[5]||(e[5]=i=>l.searchQuery2=i),class:"mb-3",density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])]),t(C,{headers:l.headers2,items:u.paginatedItems2,"item-key":"dessert",class:"table-rounded","max-height":"90vh","max-width":"800","fixed-header":""},{default:s(()=>[r("thead",null,[r("tr",null,[(n(!0),c(p,null,v(l.headers2,i=>(n(),c("th",{key:i,class:"text-center"},o(i.text),1))),128))])]),r("tbody",null,[(n(!0),c(p,null,v(u.filteredSAwisetarget2,(i,d)=>(n(),c("tr",{key:d},[r("td",be,o(d+1),1),r("td",ye,o(i.sku_name),1),r("td",ke,o(i.shipped_ordered),1),r("td",Ve,o(i.shipped_exchange),1)]))),128))])]),_:1},8,["headers","items"]),g(),we,t(_,{color:"primary",onClick:u.closeDialog2},{default:s(()=>[g(" Close ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["headers","items"]),t(q,{modelValue:l.page,"onUpdate:modelValue":e[7]||(e[7]=i=>l.page=i),length:Math.ceil(u.filteredSAwisetarget.length/l.pageSize),onInput:u.updatePagination},null,8,["modelValue","length","onInput"]),t(R,{modelValue:l.snackbar,"onUpdate:modelValue":e[8]||(e[8]=i=>l.snackbar=i),timeout:3500,color:l.color},{default:s(()=>[g(o(l.snackbarText),1)]),_:1},8,["modelValue","color"])])}const Se=I(K,[["render",Ce]]),Te={components:{AssignedTripview:Se},data(){return{currentroute:"",activeTab:"",tabs:[{title:"Assign Trip View",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=F(),this.activeTab=U(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function Ae(a,e,m,D,l,u){const i=E("AssignedTripview");return n(),c("div",null,[t(H,{modelValue:l.activeTab,"onUpdate:modelValue":e[0]||(e[0]=d=>l.activeTab=d),"show-arrows":""},{default:s(()=>[(n(!0),c(p,null,v(l.tabs,d=>(n(),O(j,{key:d.icon,value:d.tab},{default:s(()=>[t(x,{size:"20",start:"",icon:d.icon},null,8,["icon"]),g(" "+o(d.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Q),t(W,{modelValue:l.activeTab,"onUpdate:modelValue":e[1]||(e[1]=d=>l.activeTab=d),class:"mt-5 disable-tab-transition",touch:!1},{default:s(()=>[t(M,{value:"account"},{default:s(()=>[t(i)]),_:1})]),_:1},8,["modelValue"])])}const Re=I(Te,[["render",Ae]]);export{Re as default};
