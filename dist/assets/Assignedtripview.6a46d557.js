import{_ as I,o as d,c as u,g as e,w as a,i as _,j as k,k as y,l as v,m,b as g,a as o,b8 as V,F as p,q as x,t as n,u as b,bo as U,f as z,bp as N,bq as L,v as B,e as E,s as O,r as Q}from"./index.7e5301d2.js";import{s as R}from"./Services.e2ee330a.js";import{V as w}from"./VForm.c6ad41ca.js";import{V as T}from"./VAutocomplete.8599a9d6.js";import{V as D}from"./VTextField.969f3f52.js";import{V as S}from"./VTable.dc5363c0.js";import{V as C}from"./VDialog.6d843b05.js";import{V as G}from"./VPagination.c14eede1.js";import{V as H}from"./VSnackbar.3334e156.js";import{V as q,a as K,b as M,c as W}from"./VWindowItem.f305b40e.js";import"./VCounter.f7f19471.js";import"./VSelect.2e908d75.js";import"./VCheckboxBtn.96ebc215.js";import"./VChip.af398333.js";const j={mixins:[R],data(){return{expandedIndex:null,snackbar:!1,snackbarText:"",timeout:6e3,color:"",top:!1,bottom:!0,left:!1,right:!1,Enddate:"",locationdata:"",cityID:"",loading:"",cityLoaction:[],getAllsalesorderdata:[],person:[l=>!!l||"Assign Delivery Person is required"],headers:[{text:"Serial No.",value:"user_name"},{text:"City",value:"user_name"},{text:"Trip Name",value:"user_name"},{text:"Location",value:"merchant_uid"},{text:"Driver Name",value:"target_amount"},{text:"Sales Order Count",value:"achieved_target"},{text:"Action",value:"achieved_percentage"}],headers3:[{text:"So No.",value:"so_no"},{text:"Created Date",value:"so_no"},{text:"Merchant UID",value:"merchant_name"},{text:"Status",value:"status"},{text:"Invoice Number",value:"user_name"},{text:"Not Deliver Reason",value:"user_name"},{text:"Invoice File",value:"user_name"},{text:"Delivery Challan File",value:"user_name"},{text:"Action",value:"achieved_percentage"}],headers2:[{text:"Serial No.",value:"user_name"},{text:"SKU Name",value:"user_name"},{text:"Shipped Ordered",value:"user_name"},{text:"Shipped Exchange",value:"user_name"}],headers4:[{text:"SKU Name",value:"user_name"},{text:"Shipped Ordered",value:"user_name"},{text:"Shipped Exchange",value:"user_name"},{text:"Return",value:"merchant_uid"},{text:"Delivery Ordered",value:"target_amount"},{text:"Delivery Exchange",value:"achieved_target"},{text:"Delivery Exchange",value:"achieved_percentage"},{text:"Damaged",value:"achieved_percentage"}],AssignedPerson:[],deliveryPerson:[],Deliverypersondata:"",TripId:"",searchQuery:"",page:1,pageSize:10,page2:1,pageSize2:10,dialog:!1,getSalesorder:[],dialog2:!1,searchQuery2:"",dialog3:!1,soStatusdata:"",dialog4:!1}},computed:{filteredSAwisetarget(){const l=this.searchQuery.toLowerCase().trim();return this.AssignedPerson.filter(t=>t.city&&t.city.toLowerCase().includes(l)||t.delivery_person&&t.delivery_person.toLowerCase().includes(l)||t.location&&t.location.toLowerCase().includes(l)||t.sales_order_count&&t.sales_order_count.toString().includes(l)||t.trip_name&&t.trip_name.toLowerCase().includes(l))},paginatedItems(){const l=(this.page-1)*this.pageSize,t=l+this.pageSize;return this.filteredSAwisetarget.slice(l,t)},filteredSAwisetarget2(){const l=this.searchQuery2.toLowerCase().trim();return this.getSalesorder.filter(t=>t.shipped_exchange&&t.shipped_exchange.toString().includes(l)||t.shipped_ordered&&t.shipped_ordered.toString().includes(l)||t.sku_name&&t.sku_name.toLowerCase().includes(l))},paginatedItems2(){const l=(this.page2-1)*this.pageSize2,t=l+this.pageSize2;return this.filteredSAwisetarget2.slice(l,t)}},mounted(){this.cityID=localStorage.getItem("city_id"),this.handleBrandSelection()},methods:{createshippinvoice(l){this.shippedinvoice(l).then(t=>{t.data.status==1?(this.snackbar=!0,this.color="primary",this.snackbarText=t.data.message,this.AssignedPerson):(this.snackbar=!0,this.color="on-background",this.snackbarText=t.data.message)})},handlePersonSelection(l){l==="Delivered"?(this.dialog4=!0,this.dialog3=!1):this.dialog4=!1},validateForm3(){},closeDialog4(){this.dialog4=!1},editassignedrow(l){this.dialog3=!0,this.soStatusdata=l.so_status,this.soStatusdata==="Delivered"?(this.dialog4=!0,this.dialog3=!1):this.dialog4=!1},closeDialog3(){this.dialog3=!1,this.soStatusdata=""},getdeliverychallan(l){window.open(l,"_blank")},getinvoice(l){window.open(l,"_blank")},toggleExpand(l,t){this.expandedIndex=this.expandedIndex===t?null:t,this.GetTripsalesorders(l.trip_id).then(f=>{console.log("check the response",f),f.data.status==1?(this.getAllsalesorderdata=f.data.data,this.snackbar=!0,this.color="primary",this.snackbarText=f.data.message):(this.snackbar=!0,this.color="on-background",this.snackbarText=f.data.message)})},viewrow(l){this.GetTripdetails(l.trip_id).then(t=>{console.log("response",t),t.data.status==1?(this.getSalesorder=t.data.data,this.dialog2=!0,this.snackbar=!0,this.color="primary",this.snackbarText=t.data.message):(this.getSalesorder=[],this.dialog2=!1,this.snackbar=!0,this.color="on-background",this.snackbarText=t.data.message)})},closeDialog(){this.dialog=!1,this.Deliverypersondata=""},closeDialog2(){this.dialog2=!1},editrow(l){this.TripId=l.trip_id,this.Getsalesperson(this.cityID,this.locationdata).then(t=>{t.data.status==1?(this.deliveryPerson=t.data.data.map(f=>({value:f.delivery_person,text:f.name})),this.dialog=!0):(this.deliveryPerson=[],this.dialog=!1)})},validateForm2(){this.$refs.purchaseOrderForm.validate().then(l=>{l.valid==!0?this.Assigndelperson():(this.snackbar=!0,this.snackbarText="Please give all mandatory fields",this.color="on-background")})},Assigndelperson(){const l={trip_id:this.TripId,delivery_person:this.Deliverypersondata};this.Assigndeliveryperson(l).then(t=>{t.data.status==1?(this.dialog=!1,this.snackbar=!0,this.loading=!1,this.color="primary",this.snackbarText=t.data.message,this.validateForm(),this.Deliverypersondata="",this.TripId=""):(this.snackbar=!0,this.color="on-background",this.dialog=!1,this.snackbarText=t.data.message)})},updatePagination(l){this.page=l},updatePagination2(l){this.page2=l},validateForm(){this.$refs.tripform.validate().then(l=>{l.valid==!0?this.getAssignedview():(this.snackbar=!0,this.snackbarText="Please give all mandatory fields",this.color="on-background")})},getAssignedview(){this.loading=!0,this.Assignedpersondata(this.locationdata,this.Enddate).then(l=>{l.data.status==1?(this.AssignedPerson=l.data.data,this.snackbar=!0,this.loading=!1,this.color="primary",this.snackbarText=l.data.message):(this.loading=!1,this.snackbar=!0,this.color="on-background",this.AssignedPerson=[],this.snackbarText=l.data.message)})},handleBrandSelection(){this.getCitylocation(this.cityID).then(l=>{this.cityLoaction=l.data.data.map(t=>({value:t.location_id,text:t.location}))})}}},J={style:{"max-width":"400px"}},X={key:0,id:"app"},Y=N('<div id="loading-bg"><div class="loading-logo"><img src="'+L+'" height="60" width="68" alt="Logo"></div><div class="loading"><div class="effect-1 effects"></div><div class="effect-2 effects"></div><div class="effect-3 effects"></div></div></div>',1),Z=[Y],$={key:0},ee=o("td",{colspan:"16",class:"text-center"},[o("h1",null,"No data found !")],-1),te=[ee],ae={class:"text-center"},le={class:"text-center"},se={class:"text-center"},ie={class:"text-center"},oe={class:"text-center"},re={class:"text-center"},ne={class:"text-center"},de={colspan:"7"},ue={class:"text-center"},ce={class:"text-center"},he={class:"text-center"},me={class:"text-center"},ge={class:"text-center"},_e={class:"text-center"},fe={class:"text-center"},pe={class:"text-center"},ve={class:"text-center"},xe={style:{"max-width":"400px"}},be={class:"text-center"},ke={class:"text-center"},ye={class:"text-center"},Ve={class:"text-center"},we=o("br",null,null,-1);function Se(l,t,f,P,s,r){return d(),u("div",null,[e(v,null,{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[e(k,{title:"Assign Trip View",class:"mb-4"},{default:a(()=>[e(y,null,{default:a(()=>[e(w,{ref:"tripform",class:"mt-6"},{default:a(()=>[e(v,null,{default:a(()=>[e(_,{cols:"12",md:"6"},{default:a(()=>[e(T,{modelValue:s.locationdata,"onUpdate:modelValue":t[0]||(t[0]=i=>s.locationdata=i),label:"Location",items:s.cityLoaction,"item-value":"value","item-title":"text","menu-props":{maxHeight:200}},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"12",md:"6"},{default:a(()=>[e(D,{modelValue:s.Enddate,"onUpdate:modelValue":t[1]||(t[1]=i=>s.Enddate=i),type:"date",label:"Date",rules:l.endr},null,8,["modelValue","rules"])]),_:1}),e(_,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:a(()=>[e(m,{onClick:r.validateForm},{default:a(()=>[g(" Get ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1}),o("div",J,[e(D,{modelValue:s.searchQuery,"onUpdate:modelValue":t[2]||(t[2]=i=>s.searchQuery=i),class:"mb-3",density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])]),s.loading?(d(),u("div",X,Z)):V("",!0),e(S,{headers:s.headers,items:r.paginatedItems,"item-key":"dessert",class:"table-rounded",height:"500","fixed-header":""},{default:a(()=>[o("thead",null,[o("tr",null,[(d(!0),u(p,null,x(s.headers,i=>(d(),u("th",{key:i,class:"text-center"},n(i.text),1))),128))])]),o("tbody",null,[r.filteredSAwisetarget.length===0?(d(),u("tr",$,te)):V("",!0),(d(!0),u(p,null,x(r.filteredSAwisetarget,(i,c)=>(d(),u(p,{key:c},[o("tr",null,[o("td",ae,n(c+1),1),o("td",le,n(i.city),1),o("td",se,n(i.trip_name),1),o("td",ie,n(i.location),1),o("td",oe,n(i.delivery_person),1),o("td",re,n(i.sales_order_count),1),o("td",ne,[e(m,{icon:"",variant:"text",color:"default",class:"mb-1 mt-2",size:"x-small",onClick:h=>r.createshippinvoice(i.trip_id)},{default:a(()=>[e(b,{icon:"iwwa:file-pdf",size:"22",color:"error"})]),_:2},1032,["onClick"]),e(m,{icon:"",variant:"text",color:"default",class:"mb-1 mt-2",size:"x-small",onClick:h=>r.toggleExpand(i,c)},{default:a(()=>[e(b,{icon:s.expandedIndex===c?"mdi-minus":"mdi-plus",size:"22",color:"#BA8B32"},null,8,["icon"])]),_:2},1032,["onClick"]),e(m,{icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:h=>r.editrow(i)},{default:a(()=>[e(b,{icon:"ri-pencil-line",size:"22",color:"#BA8B32"})]),_:2},1032,["onClick"]),e(m,{icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:h=>r.viewrow(i)},{default:a(()=>[e(b,{color:"success",icon:"basil:eye-outline",size:"22"})]),_:2},1032,["onClick"])])]),s.expandedIndex===c?(d(),u("tr",{key:`expanded-${c}`},[o("td",de,[e(U,null,{default:a(()=>[o("div",null,[e(S,{dense:""},{default:a(()=>[o("thead",null,[o("tr",null,[(d(!0),u(p,null,x(s.headers3,h=>(d(),u("th",{key:h,class:"text-center"},n(h.text),1))),128))])]),o("tbody",null,[(d(!0),u(p,null,x(s.getAllsalesorderdata,(h,F)=>(d(),u("tr",{key:F},[o("td",ue,n(h.so_number),1),o("td",ce,n(h.created_date),1),o("td",he,n(h.merchant_uid),1),o("td",me,n(h.so_status),1),o("td",ge,n(h.invoice_number),1),o("td",_e,n(h.not_delivered_reason),1),o("td",fe,[e(m,{icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:A=>r.getinvoice(h.invoice_file)},{default:a(()=>[e(b,{color:"error",icon:"iwwa:file-pdf",size:"26"})]),_:2},1032,["onClick"])]),o("td",pe,[e(m,{icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:A=>r.getdeliverychallan(h.delivery_challan_file)},{default:a(()=>[e(b,{color:"error",icon:"iwwa:file-pdf",size:"26"})]),_:2},1032,["onClick"])]),o("td",ve,[e(m,{icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:A=>r.editassignedrow(h)},{default:a(()=>[e(b,{icon:"ri-pencil-line",size:"22",color:"#BA8B32"})]),_:2},1032,["onClick"])])]))),128))])]),_:2},1024)])]),_:2},1024)])])):V("",!0)],64))),128))]),e(C,{modelValue:s.dialog,"onUpdate:modelValue":t[4]||(t[4]=i=>s.dialog=i),"max-width":"400",persistent:""},{default:a(()=>[e(k,{title:"Assign Delivery Person",class:"mb-2"},{default:a(()=>[e(y,null,{default:a(()=>[e(v,null,{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[e(w,{ref:"purchaseOrderForm",class:"mt-4"},{default:a(()=>[e(v,null,{default:a(()=>[e(_,{md:"12",cols:"12"},{default:a(()=>[e(T,{modelValue:s.Deliverypersondata,"onUpdate:modelValue":t[3]||(t[3]=i=>s.Deliverypersondata=i),items:s.deliveryPerson,"item-value":"value","item-title":"text",label:"Assign Delivery Person",rules:s.person,"menu-props":{maxHeight:200}},null,8,["modelValue","items","rules"])]),_:1}),e(_,{md:"12",cols:"12"},{default:a(()=>[e(m,{onClick:r.validateForm2},{default:a(()=>[g(" Save ")]),_:1},8,["onClick"]),g(" \xA0 "),e(m,{color:"secondary",variant:"tonal",onClick:r.closeDialog},{default:a(()=>[g(" Close ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(C,{modelValue:s.dialog2,"onUpdate:modelValue":t[6]||(t[6]=i=>s.dialog2=i),"max-width":"800"},{default:a(()=>[e(k,{title:"View Trip Sales Orders",class:"mb-2"},{default:a(()=>[e(y,null,{default:a(()=>[o("div",xe,[e(D,{modelValue:s.searchQuery2,"onUpdate:modelValue":t[5]||(t[5]=i=>s.searchQuery2=i),class:"mb-3",density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])]),e(S,{headers:s.headers2,items:r.paginatedItems2,"item-key":"dessert",class:"table-rounded","max-height":"90vh","max-width":"800","fixed-header":""},{default:a(()=>[o("thead",null,[o("tr",null,[(d(!0),u(p,null,x(s.headers2,i=>(d(),u("th",{key:i,class:"text-center"},n(i.text),1))),128))])]),o("tbody",null,[(d(!0),u(p,null,x(r.filteredSAwisetarget2,(i,c)=>(d(),u("tr",{key:c},[o("td",be,n(c+1),1),o("td",ke,n(i.sku_name),1),o("td",ye,n(i.shipped_ordered),1),o("td",Ve,n(i.shipped_exchange),1)]))),128))])]),_:1},8,["headers","items"]),g(),we,e(m,{color:"primary",onClick:r.closeDialog2},{default:a(()=>[g(" Close ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["headers","items"]),e(C,{modelValue:s.dialog3,"onUpdate:modelValue":t[9]||(t[9]=i=>s.dialog3=i),"max-width":"400",persistent:""},{default:a(()=>[e(k,{title:"SO Status Change",class:"mb-2"},{default:a(()=>[e(y,null,{default:a(()=>[e(v,null,{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[e(w,{ref:"purchaseOrderForms",class:"mt-4"},{default:a(()=>[e(v,null,{default:a(()=>[e(_,{md:"12",cols:"12"},{default:a(()=>[e(T,{modelValue:s.soStatusdata,"onUpdate:modelValue":[t[7]||(t[7]=i=>s.soStatusdata=i),t[8]||(t[8]=i=>r.handlePersonSelection(s.soStatusdata))],items:["Delivered","Ready To Ship","On Hold"],label:"Assign Delivery Person",rules:s.person,"menu-props":{maxHeight:200}},null,8,["modelValue","rules"])]),_:1}),s.soStatusdata!="Delivered"?(d(),z(_,{key:0,md:"12",cols:"12"},{default:a(()=>[e(m,{onClick:r.validateForm3},{default:a(()=>[g(" Save ")]),_:1},8,["onClick"]),g(" \xA0 "),e(m,{color:"secondary",variant:"tonal",onClick:r.closeDialog3},{default:a(()=>[g(" Close ")]),_:1},8,["onClick"])]),_:1})):V("",!0)]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(C,{modelValue:s.dialog4,"onUpdate:modelValue":t[10]||(t[10]=i=>s.dialog4=i),"max-width":"800",persistent:""},{default:a(()=>[e(k,{title:"Table",class:"mb-2"},{default:a(()=>[e(y,null,{default:a(()=>[e(v,null,{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[e(w,{ref:"purchaseOrderForms",class:"mt-4"},{default:a(()=>[e(v,null,{default:a(()=>[e(S,{headers:s.headers4,"item-key":"dessert",class:"table-rounded","max-height":"90vh","max-width":"800","fixed-header":""},{default:a(()=>[o("thead",null,[o("tr",null,[(d(!0),u(p,null,x(s.headers4,i=>(d(),u("th",{key:i,class:"text-center"},n(i.text),1))),128))])])]),_:1},8,["headers"]),e(_,{md:"12",cols:"12"},{default:a(()=>[e(m,{onClick:l.validateForm4},{default:a(()=>[g(" Save ")]),_:1},8,["onClick"]),g(" \xA0 "),e(m,{color:"secondary",variant:"tonal",onClick:r.closeDialog4},{default:a(()=>[g(" Close ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(G,{modelValue:s.page,"onUpdate:modelValue":t[11]||(t[11]=i=>s.page=i),length:Math.ceil(r.filteredSAwisetarget.length/s.pageSize),onInput:r.updatePagination},null,8,["modelValue","length","onInput"]),e(H,{modelValue:s.snackbar,"onUpdate:modelValue":t[12]||(t[12]=i=>s.snackbar=i),timeout:3500,color:s.color},{default:a(()=>[g(n(s.snackbarText),1)]),_:1},8,["modelValue","color"])])}const Ce=I(j,[["render",Se]]),Te={components:{AssignedTripview:Ce},data(){return{currentroute:"",activeTab:"",tabs:[{title:"Assign Trip View",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=B(),this.activeTab=E(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function De(l,t,f,P,s,r){const i=Q("AssignedTripview");return d(),u("div",null,[e(q,{modelValue:s.activeTab,"onUpdate:modelValue":t[0]||(t[0]=c=>s.activeTab=c),"show-arrows":""},{default:a(()=>[(d(!0),u(p,null,x(s.tabs,c=>(d(),z(W,{key:c.icon,value:c.tab},{default:a(()=>[e(b,{size:"20",start:"",icon:c.icon},null,8,["icon"]),g(" "+n(c.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),e(O),e(M,{modelValue:s.activeTab,"onUpdate:modelValue":t[1]||(t[1]=c=>s.activeTab=c),class:"mt-5 disable-tab-transition",touch:!1},{default:a(()=>[e(K,{value:"account"},{default:a(()=>[e(i)]),_:1})]),_:1},8,["modelValue"])])}const He=I(Te,[["render",De]]);export{He as default};
