import{a2 as q,am as M,an as Q,X as j,b3 as L,e as I,H as W,J as w,ag as H,K as Y,g as l,as as J,S as K,b4 as X,aj as Z,_ as O,o as p,c as f,w as r,i as _,j as N,k,l as T,m as S,u as R,a as t,F as y,s as F,t as c,b as h,n as v,v as E,aZ as $,x as tt,r as et,f as at}from"./index.6da2e979.js";import{a as D}from"./index.2bd8ddc8.js";import{V as U}from"./VForm.b925c575.js";import{V}from"./VSelect.e68a8a58.js";import{V as lt}from"./VTable.c1246c5f.js";import{V as B}from"./VChip.b9089837.js";import{V as st,a as ot,b as nt,c as rt}from"./VWindowItem.26c2ca04.js";import"./VCheckboxBtn.6c2e9b83.js";const ct={data(){return{url:"http://103.211.218.32/"}},methods:{getBrands(){return D.get(this.url+"bizkingz/services/api/brands/getBrands",{headers:{"Content-Type":"application/json",accept:"*/*"}}).then(e=>e.data)},getBrandproducts(e){return D.get(this.url+"bizkingz/services/api/brands/getBrandsProducts?brand_id="+e,{headers:{"Content-Type":"application/json",accept:"*/*"}}).then(a=>a.data)}}};const dt=q()({name:"VDialog",inheritAttrs:!1,props:{fullscreen:Boolean,origin:{type:String,default:"center center"},retainFocus:{type:Boolean,default:!0},scrollable:Boolean,modelValue:Boolean,...M({transition:{component:Q}})},emits:{"update:modelValue":e=>!0},setup(e,a){let{attrs:d,slots:u}=a;const s=j(e,"modelValue"),{scopeId:n}=L(),o=I();function i(m){var x,g;const C=m.relatedTarget,A=m.target;if(C!==A&&(x=o.value)!=null&&x.contentEl&&(g=o.value)!=null&&g.globalTop&&![document,o.value.contentEl].includes(A)&&!o.value.contentEl.contains(A)){const b=[...o.value.contentEl.querySelectorAll('button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])')].filter(G=>!G.hasAttribute("disabled")&&!G.matches('[tabindex="-1"]'));if(!b.length)return;const P=b[0],z=b[b.length-1];C===P?z.focus():P.focus()}}return W&&w(()=>s.value&&e.retainFocus,m=>{m?document.addEventListener("focusin",i):document.removeEventListener("focusin",i)},{immediate:!0}),w(s,async m=>{if(await H(),m){var x;(x=o.value.contentEl)==null||x.focus({preventScroll:!0})}else{var g;(g=o.value.activatorEl)==null||g.focus({preventScroll:!0})}}),Y(()=>l(X,K({modelValue:s.value,"onUpdate:modelValue":m=>s.value=m,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable}],transition:e.transition,scrollStrategy:"block",ref:o,"aria-role":"dialog","aria-modal":"true",activatorProps:{"aria-haspopup":"dialog","aria-expanded":String(s.value)},"z-index":2400},n,d),{activator:u.activator,default:()=>{var m;return l(J,{root:!0},{default:()=>[(m=u.default)==null?void 0:m.call(u)]})}})),Z({},o)}}),ut={mixins:[ct],components:{},data(){return{quantityInput:0,AllBrandproducts:[],createdBy:"",Brandname:[],totals:{Quantity:0,TaxableAmmount:0,CGST:0,SGST:0,Ammount:0},today:new Date().toISOString().substr(0,10),selectedDate:new Date().toISOString().substr(0,10),landscape:!1,noTitle:!1,selectedPurchaseOrder:null,dialog:!1,headers:[{text:"Product Name",value:"sku_name"},{text:"HSN",value:"hsn_code"},{text:"MRP",value:"mrp"},{text:"Quantity",value:"quantity"},{text:"UOM",value:"uom"},{text:"Price/Unit",value:"calculatedPricePerUnit"},{text:"TaxableAmmount",value:"calculatedTaxableAmount"},{text:"CGST",value:"calculatedCGSTAmount"},{text:"SGST",value:"calculatedSGSTAmount"},{text:"Ammount",value:"calculateTotalamount"},{text:"Actions",value:"action"}]}},computed:{totalIndividualAmount(){return this.AllBrandproducts.reduce((e,a)=>{const d=parseFloat(a.mrp),u=parseFloat(a.quantity),s=d*u;return console.log("check",e+s),e+s},0)},savedamount(){const e=this.totalIndividualAmount-parseFloat(this.allAmmount);return console.log("totalsave",e),Math.max(0,e).toFixed(2)},allAmmount(){const e=this.calculateTotalamount.reduce((a,d)=>a+parseFloat(d),0);return parseFloat(e.toFixed(2))},allSGSTAmount(){const e=this.calculatedSGSTAmount.reduce((a,d)=>a+parseFloat(d),0);return parseFloat(e.toFixed(2))},allCGSTAmount(){const e=this.calculatedCGSTAmount.reduce((a,d)=>a+parseFloat(d),0);return parseFloat(e.toFixed(2))},allTaxableAmmount(){const e=this.calculatedTaxableAmount.reduce((a,d)=>a+parseFloat(d),0);return parseFloat(e.toFixed(2))},allQuantity(){const e=this.AllBrandproducts.reduce((a,d)=>a+parseFloat(d.quantity),0);return isNaN(e)?0:e.toFixed(0)},calculateTotalamount(){return this.AllBrandproducts.map((e,a)=>{const d=parseFloat(this.calculatedTaxableAmount[a]),u=parseFloat(this.calculatedCGSTAmount[a]),s=parseFloat(this.calculatedSGSTAmount[a]),n=d+u+s;return isNaN(n)?0:n.toFixed(2)})},calculatedSGSTAmount(){return this.AllBrandproducts.map((e,a)=>{const d=parseFloat(this.calculatedTaxableAmount[a]),u=parseFloat(e.sgst.replace("%","")),s=d*u/100;return isNaN(s)?0:s.toFixed(2)})},calculatedCGSTAmount(){return this.AllBrandproducts.map((e,a)=>{const d=parseFloat(this.calculatedTaxableAmount[a]),u=parseFloat(e.cgst.replace("%","")),s=d*u/100;return isNaN(s)?0:s.toFixed(2)})},calculatedPricePerUnit(){return this.AllBrandproducts.map(e=>{const a=parseFloat(e.mrp),d=parseFloat(e.total_given_margin.replace("%","")),u=a-a*d/100;return isNaN(u)?0:u.toFixed(2)})},calculatedTaxableAmount(){return this.AllBrandproducts.map((e,a)=>{const d=parseFloat(e.quantity),u=this.calculatedPricePerUnit[a],s=parseFloat(u);if(isNaN(s))return console.log(`Invalid value at index ${a}: ${u}`),0;const n=d*s;return isNaN(n)?0:n.toFixed(2)})},brandNames(){return this.Brandname.map(e=>e.brand_name)}},mounted(){this.getBrandsdata(),this.createdBy=localStorage.getItem("createdby")},methods:{colorTGMmargin(e){return e?{color:"success"}:{color:"error"}},colorSGSTmargin(e){return e?{color:"success"}:{color:"error"}},colorCGSTmargin(e){return e?{color:"success"}:{color:"error"}},handleBrandSelection(){console.log("Brand changed:",this.selectedPurchaseOrder);const e=this.Brandname.find(a=>a.brand_name===this.selectedPurchaseOrder);console.log("Select",e),e&&(this.selectedBrandId=e.brand_id,this.getBrandproducts(this.selectedBrandId).then(a=>{this.AllBrandproducts=a.data,console.log("BrandID",this.AllBrandproducts)}))},getBrandsdata(){this.getBrands().then(e=>{this.Brandname=e.data,console.log("check the response",this.Brandname)})},onDateChange(){console.log("Selected date:",this.selectedDate)},deleteRow(e){const a=this.AllBrandproducts.indexOf(e);a!==-1&&this.AllBrandproducts.splice(a,1)},openproductdialog(){console.log("check the dialog"),this.dialog=!0},closeDialog(){this.dialog=!1}}},it={class:"text-center"},mt={class:"text-center"},ht={class:"text-center"},_t={class:"text-center"},pt={class:"text-center"},ft={class:"text-center"},xt=t("br",null,null,-1),gt={class:"text-center"},vt={class:"text-center"},bt=t("br",null,null,-1),At={class:"text-center"},Tt=t("br",null,null,-1),St={class:"text-center"},Vt=t("td",{class:"text-center"},"Total",-1),Bt=t("td",null,null,-1),yt=t("td",null,null,-1),Ft={class:"text-center"},Ct=t("td",null,null,-1),Pt=t("td",null,null,-1),Gt={class:"text-center"},wt={class:"text-center"},Nt={class:"text-center"},kt={class:"text-center"},Dt=t("td",null,null,-1),Ut=t("td",{class:"text-left"},"Tax Details",-1),It={colspan:"4",class:"text-right"},Ot=t("td",{colspan:"4",class:"text-left"},"Ammounts:",-1),Rt=t("td",{colspan:"4",class:"text-center"},null,-1),Et=t("td",{class:"text-left"},"CGST",-1),zt={colspan:"4",class:"text-right"},qt=t("td",{colspan:"4",class:"text-left"},"SubTotal",-1),Mt={colspan:"4",class:"text-center"},Qt=t("td",{class:"text-left"},"SGST",-1),jt={colspan:"4",class:"text-right"},Lt=t("td",{colspan:"4",class:"text-left"},"Total",-1),Wt={colspan:"4",class:"text-center"},Ht=t("td",{class:"text-left"},null,-1),Yt=t("td",{colspan:"4",class:"text-right"},null,-1),Jt=t("td",{colspan:"4",class:"text-left"},"Advance",-1),Kt={colspan:"4",class:"text-center"},Xt=t("td",{class:"text-left"},null,-1),Zt=t("td",{colspan:"4",class:"text-right"},null,-1),$t=t("td",{colspan:"4",class:"text-left"},"Balance",-1),te={colspan:"4",class:"text-center"},ee=t("td",{class:"text-left"},null,-1),ae=t("td",{colspan:"4",class:"text-right"},null,-1),le=t("td",{colspan:"4",class:"text-left"},"You Saved",-1),se={colspan:"4",class:"text-center"};function oe(e,a,d,u,s,n){return p(),f("div",null,[l(T,null,{default:r(()=>[l(_,{cols:"12"},{default:r(()=>[l(N,{title:"Purchase Order",class:"mb-4"},{default:r(()=>[l(k,null,{default:r(()=>[l(U,{class:"mt-6"},{default:r(()=>[l(T,null,{default:r(()=>[l(_,{md:"6",cols:"12"},{default:r(()=>[l(V,{modelValue:s.selectedPurchaseOrder,"onUpdate:modelValue":[a[0]||(a[0]=o=>s.selectedPurchaseOrder=o),n.handleBrandSelection],label:"Brand or Manufacturer",items:n.brandNames},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(_,{cols:"12",md:"6"},{default:r(()=>[l(S,{modelValue:s.createdBy,"onUpdate:modelValue":a[1]||(a[1]=o=>s.createdBy=o),label:"Created By"},null,8,["modelValue"])]),_:1}),l(_,{cols:"12",md:"6"},{default:r(()=>[l(S,{modelValue:s.selectedDate,"onUpdate:modelValue":a[2]||(a[2]=o=>s.selectedDate=o),type:"date",label:"Date",min:s.today,value:e.formattedDate},null,8,["modelValue","min","value"])]),_:1}),l(_,{md:"6",cols:"12"},{default:r(()=>[l(V,{label:"PO Status",items:["Draft","Created","Shared","Acknowledged","Received","Close"]})]),_:1}),l(R),l(_,{cols:"12"},{default:r(()=>[l(lt,{headers:s.headers,items:s.AllBrandproducts},{default:r(()=>[t("thead",null,[t("tr",null,[(p(!0),f(y,null,F(s.headers,o=>(p(),f("th",{class:"text-center",key:o},c(o.text),1))),128))])]),t("tbody",null,[(p(!0),f(y,null,F(s.AllBrandproducts,(o,i)=>(p(),f("tr",{key:i},[t("td",it,c(o.sku_name),1),t("td",mt,c(o.hsn_code),1),t("td",ht," \u20B9"+c(o.mrp),1),t("td",_t,[l(S,{modelValue:o.quantity,"onUpdate:modelValue":m=>o.quantity=m,type:"number",style:{"min-width":"80px"}},null,8,["modelValue","onUpdate:modelValue"])]),t("td",pt,c(o.uom),1),t("td",ft,[h(" \u20B9 "+c(n.calculatedPricePerUnit[i])+" ",1),xt,l(B,{color:n.colorTGMmargin(o.total_given_margin).color,class:"font-weight-medium",size:"small"},{default:r(()=>[h(" ("+c(o.total_given_margin)+") ",1)]),_:2},1032,["color"])]),t("td",gt," \u20B9"+c(n.calculatedTaxableAmount[i]),1),t("td",vt,[h(" \u20B9"+c(n.calculatedCGSTAmount[i])+" ",1),bt,l(B,{color:n.colorCGSTmargin(o.cgst).color,class:"font-weight-medium",size:"small"},{default:r(()=>[h(" ("+c(o.cgst)+") ",1)]),_:2},1032,["color"])]),t("td",At,[h(" \u20B9"+c(n.calculatedSGSTAmount[i])+" ",1),Tt,l(B,{color:n.colorSGSTmargin(o.sgst).color,class:"font-weight-medium",size:"small"},{default:r(()=>[h(" ("+c(o.sgst)+") ",1)]),_:2},1032,["color"])]),t("td",St," \u20B9"+c(n.calculateTotalamount[i]),1),t("td",null,[l(v,{icon:"",variant:"text",color:"error",class:"me-2",size:"small",onClick:m=>n.deleteRow(o)},{default:r(()=>[l(E,{icon:"mdi-minus-circle-outline",size:"24"})]),_:2},1032,["onClick"])])]))),128))]),t("tfoot",null,[t("tr",null,[Vt,Bt,yt,t("td",Ft,c(n.allQuantity),1),Ct,Pt,t("td",Gt," \u20B9"+c(n.allTaxableAmmount),1),t("td",wt," \u20B9"+c(n.allCGSTAmount),1),t("td",Nt," \u20B9"+c(n.allSGSTAmount),1),t("td",kt," \u20B9"+c(n.allAmmount),1),Dt]),t("tr",null,[Ut,t("td",It,c(s.totals.tax),1),Ot,Rt]),t("tr",null,[Et,t("td",zt,"\u20B9"+c(n.allCGSTAmount),1),qt,t("td",Mt,"\u20B9"+c(n.allAmmount),1)]),t("tr",null,[Qt,t("td",jt,"\u20B9"+c(n.allSGSTAmount),1),Lt,t("td",Wt,"\u20B9"+c(n.allAmmount),1)]),t("tr",null,[Ht,Yt,Jt,t("td",Kt,"\u20B9"+c(s.totals.Quantity),1)]),t("tr",null,[Xt,Zt,$t,t("td",te,"\u20B9"+c(n.allAmmount),1)]),t("tr",null,[ee,ae,le,t("td",se,"\u20B9"+c(n.savedamount),1)])])]),_:1},8,["headers","items"])]),_:1}),l(_,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:r(()=>[l(v,null,{default:r(()=>[h("Save")]),_:1}),l(v,{color:"secondary",variant:"tonal",type:"reset"},{default:r(()=>[h(" Reset ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(dt,{modelValue:s.dialog,"onUpdate:modelValue":a[3]||(a[3]=o=>s.dialog=o),"max-width":"600"},{default:r(()=>[l(N,{title:"Add Your Product"},{default:r(()=>[l(k,null,{default:r(()=>[l(U,{class:"mt-6"},{default:r(()=>[l(T,null,{default:r(()=>[l(_,{md:"6",cols:"12"},{default:r(()=>[l(V,{label:"Products",items:["Normal Eggs","Premium Eggs","Poori","Methi Chapathi","Ragi Chapathi"]})]),_:1}),l(_,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:r(()=>[l(v,null,{default:r(()=>[h("Add")]),_:1}),l(v,{color:"secondary",variant:"tonal",type:"reset",onClick:n.closeDialog},{default:r(()=>[h(" Close ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),l($)]),_:1})]),_:1},8,["modelValue"])])}const ne=O(ut,[["render",oe]]),re={components:{Addpurchaseorders:ne},data(){return{currentroute:"",activeTab:"",tabs:[{title:"Create Purchase Order",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=tt(),this.activeTab=I(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function ce(e,a,d,u,s,n){const o=et("Addpurchaseorders");return p(),f("div",null,[l(st,{modelValue:s.activeTab,"onUpdate:modelValue":a[0]||(a[0]=i=>s.activeTab=i),"show-arrows":""},{default:r(()=>[(p(!0),f(y,null,F(s.tabs,i=>(p(),at(rt,{key:i.icon,value:i.tab},{default:r(()=>[l(E,{size:"20",start:"",icon:i.icon},null,8,["icon"]),h(" "+c(i.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),l(R),l(nt,{modelValue:s.activeTab,"onUpdate:modelValue":a[1]||(a[1]=i=>s.activeTab=i),class:"mt-5 disable-tab-transition",touch:!1},{default:r(()=>[l(ot,{value:"account"},{default:r(()=>[l(o)]),_:1})]),_:1},8,["modelValue"])])}const xe=O(re,[["render",ce]]);export{xe as default};
