import{_ as V,o as u,c as h,g as t,w as a,i as n,j as v,k as g,l as f,m as p,b as d,t as b,v as x,e as k,F as w,q as A,s as T,r as S,f as R,u as y}from"./index.8007ba2c.js";import{s as D}from"./Services.b92ab0ba.js";import{V as F}from"./VForm.1aaca26a.js";import{V as _}from"./VAutocomplete.f37f5fc6.js";import{V as I}from"./VTextField.07a7cc76.js";import{V as C}from"./VSnackbar.921eb609.js";import{V as B,a as U,b as q,c as N}from"./VWindowItem.8c192cf8.js";import"./VCounter.a48fda68.js";import"./VSelect.a342d2e4.js";import"./VCheckboxBtn.688ecec2.js";import"./VChip.d2cfba1c.js";const W={mixins:[D],data(){return{snackbar:!1,snackbarText:"",timeout:6e3,color:"",top:!1,bottom:!0,left:!1,right:!1,cityID:"",text:123,salesdata:[],salesassicate:"",merchantsawise:"",Routename:"",merchantSA:[],merchantSAdata:[],routerules:[o=>!!o||"Route Name is required"],routesdata:{}}},mounted(){this.cityID=localStorage.getItem("city_id"),this.getAllsales(),console.log("tric",this.cityID)},methods:{validateForm(){this.$refs.purchaseOrderForm.validate().then(o=>{o.valid==!0?this.saveRoutedetails():(this.snackbar=!0,this.snackbarText="Please give all mandatory fields",this.color="on-background")})},saveRoutedetails(){const o={route_name:this.Routename,user_id:this.salesassicate,merchants:this.merchantsawise.map(e=>{const s=this.merchantSA.find(c=>c.value===e);return s?{merchant_id:s.value,merchant_uid:s.text,merchant_name:s.merchant_name,latitude:s.latitude,longitude:s.longitude}:(console.warn(`Merchant with ID ${e} not found in merchantSA`),null)}).filter(e=>e!==null)};console.log("check route",o),this.saveRoute(o).then(e=>{console.log("check route",e),e.data.status==1?(this.snackbar=!0,this.snackbarText=e.data.message,this.color="primary",window.location.reload()):(this.snackbar=!0,this.snackbarText=e.data.message,this.color="on-background")})},handleBrandSelection(o){this.getmerchantsawise(o).then(e=>{console.log("check rp",e),this.merchantSA=e.data.map(s=>({value:s.merchant_id,text:s.merchant_uid,merchant_name:s.merchant_name,latitude:s.latitude,longitude:s.longitude}))})},getAllsales(){this.getSalesassociate(this.cityID).then(o=>{console.log("sales",o),this.salesdata=o.data.data,this.salesdata=this.salesdata.map(e=>({value:e.user_id,text:e.name})),console.log("sales",this.salesdata)})}}};function H(o,e,s,c,l,m){return u(),h("div",null,[t(f,null,{default:a(()=>[t(n,{cols:"12"},{default:a(()=>[t(v,{title:"Add Routes",class:"mb-4"},{default:a(()=>[t(g,null,{default:a(()=>[t(F,{class:"mt-6",ref:"purchaseOrderForm"},{default:a(()=>[t(f,null,{default:a(()=>[t(n,{cols:"12",md:"6"},{default:a(()=>[t(_,{modelValue:l.salesassicate,"onUpdate:modelValue":[e[0]||(e[0]=r=>l.salesassicate=r),e[1]||(e[1]=r=>m.handleBrandSelection(l.salesassicate))],label:"Sales Associate",items:this.salesdata,"item-value":"value","item-title":"text","menu-props":{maxHeight:200},required:""},null,8,["modelValue","items"])]),_:1}),t(n,{cols:"12",md:"6"},{default:a(()=>[t(_,{modelValue:this.merchantsawise,"onUpdate:modelValue":e[2]||(e[2]=r=>this.merchantsawise=r),label:"Merchants SA Wise",items:this.merchantSA,"item-value":"value","item-title":"text",multiple:"",required:"",chips:"","menu-props":{maxHeight:200}},null,8,["modelValue","items"])]),_:1}),t(n,{cols:"12",md:"6"},{default:a(()=>[t(I,{modelValue:this.Routename,"onUpdate:modelValue":e[3]||(e[3]=r=>this.Routename=r),label:"Route Name",rules:l.routerules,required:""},null,8,["modelValue","rules"])]),_:1}),t(n,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:a(()=>[t(p,{onClick:e[4]||(e[4]=r=>m.validateForm())},{default:a(()=>[d("Save")]),_:1}),t(p,{color:"secondary",variant:"tonal",type:"reset"},{default:a(()=>[d(" Reset ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1}),t(C,{modelValue:l.snackbar,"onUpdate:modelValue":e[5]||(e[5]=r=>l.snackbar=r),timeout:2e3,color:l.color},{default:a(()=>[d(b(l.snackbarText),1)]),_:1},8,["modelValue","color"])])}const M=V(W,[["render",H],["__scopeId","data-v-0d471241"]]),O={components:{Addroutes:M},data(){return{currentroute:"",activeTab:"",tabs:[{title:"Add Routes",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=x(),this.activeTab=k(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function j(o,e,s,c,l,m){const r=S("Addroutes");return u(),h("div",null,[t(B,{modelValue:l.activeTab,"onUpdate:modelValue":e[0]||(e[0]=i=>l.activeTab=i),"show-arrows":""},{default:a(()=>[(u(!0),h(w,null,A(l.tabs,i=>(u(),R(N,{key:i.icon,value:i.tab},{default:a(()=>[t(y,{size:"20",start:"",icon:i.icon},null,8,["icon"]),d(" "+b(i.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(T),t(q,{modelValue:l.activeTab,"onUpdate:modelValue":e[1]||(e[1]=i=>l.activeTab=i),class:"mt-5 disable-tab-transition",touch:!1},{default:a(()=>[t(U,{value:"account"},{default:a(()=>[t(r)]),_:1})]),_:1},8,["modelValue"])])}const $=V(O,[["render",j]]);export{$ as default};
