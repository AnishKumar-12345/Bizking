import{_ as V,o as l,c as d,g as s,w as u,i as p,j as D,k as O,l as b,m,a as c,F as x,s as f,t as h,b as k,b0 as y,n as S,x as v,e as w,u as q,r as T,f as C,v as E}from"./index.4ba6e09e.js";import{s as U}from"./Services.8ccc7918.js";import{V as F}from"./VForm.ce948013.js";import{V as Q}from"./VSelect.ab378d35.js";import{V as P}from"./VTable.658b1e60.js";import{V as B}from"./VChip.7e7c907c.js";import{V as R}from"./VSnackbar.c3a3331b.js";import{V as K,a as N,b as A,c as z}from"./VWindowItem.5917a1e6.js";import"./index.2bd8ddc8.js";import"./VCheckboxBtn.d8b7733e.js";const I={mixins:[U],props:["so_id"],data(){return{snackbar:!1,snackbarText:"",timeout:6e3,color:"",top:!1,bottom:!0,left:!1,right:!1,selectedPurchaseOrder:null,dialog:!1,Soid:"",OutputStockDetails:[],today:this.getFormattedDate(new Date),outputStock:{so_id:"",so_number:"",merchant_id:"",merchant_code:"",merchant_name:"",total_cgst:"",total_sgst:"",sub_total:"",total_margin:"",total_so_amount:"",total_quantity:"",created_date:"",shipped_date:this.getFormattedDate(new Date),so_status:"",products:[{merchant_product_id:"",sku_name:"",hsn_code:"",mrp:"",margin:"",ordered_quantity:"",warehouse_quantity:"",uom:"",price_per_unit:"",taxable_amount:"",cgst:"",sgst:"",amount:"",sgst_percentage:"",cgst_percentage:"",exchange:"",return:"",shipped_ordered:"",shipped_exchange:""}]},outputStockproducts:[],headers:[{text:"Exchange Quantity",value:"exchange_quantity"},{text:"Ordered Quantity",value:"ordered_quantity"},{text:"Available",value:"warehouse_quantity"},{text:"Shipped Ordered",value:"shipped_ordered"},{text:"Shipped Exchanged",value:"shipped_exchange"}]}},computed:{},mounted(){this.Soid=this.$route.query.so_id,console.log("Received po_id:",this.Soid),this.getOutputstockdetails()},methods:{preventPaste(e){const _=(e.clipboardData||window.clipboardData).getData("text");/^[0-9]+$/.test(_)||e.preventDefault()},preventDecimal(e){(e.key==="."||e.key===","||e.key==="+"||e.key==="-"||e.keyCode===189||e.keyCode===109)&&e.preventDefault()},saveOutputstock(){const e={Draft:1,Created:2,Acknowledged:3,Shipped:4,Delivered:5},a={so_id:this.OutputStockDetails.so_id,so_number:this.outputStock.so_number,so_status:e[this.outputStock.so_status],merchant_id:this.OutputStockDetails.merchant_id,merchant_code:this.OutputStockDetails.merchant_code,merchant_name:this.outputStock.merchant_name,total_cgst:this.OutputStockDetails.total_cgst,total_sgst:this.OutputStockDetails.total_sgst,sub_total:this.OutputStockDetails.sub_total,total_margin:this.OutputStockDetails.total_margin,total_so_amount:this.OutputStockDetails.total_so_amount,total_quantity:this.OutputStockDetails.total_quantity,created_date:this.OutputStockDetails.created_date,shipped_date:this.outputStock.shipped_date,products:this.outputStockproducts.filter(t=>t.shipped_ordered>0||t.shipped_exchange>0).map((t,r)=>({merchant_product_id:t.merchant_product_id,sku_name:t.sku_name,hsn_code:t.hsn_code,mrp:t.mrp,margin:t.margin,margin_percentage:t.margin_percentage,quantity:t.ordered_quantity,uom:t.uom,price_per_unit:t.price_per_unit,taxable_amount:t.taxable_amount,cgst:t.cgst,sgst:t.sgst,amount:t.amount,sgst_percentage:t.sgst_percentage,cgst_percentage:t.cgst_percentage,exchange:t.exchange,return:t.return,shipped_ordered:`${t.shipped_ordered}`,shipped_exchange:`${t.shipped_exchange}`}))};console.log("check the post data",a),a.products.filter(t=>(console.log("sit",this.isQuantityExceeded(t.shipped_ordered,t.ordered_quantity)),this.isQuantityExceeded(t.shipped_ordered,t.ordered_quantity)||this.isQuantityExceeded2(t.shipped_exchange,t.exchange_quantity))).length===0?this.postOutputstock(a).then(t=>{console.log("check the response",t),t.status==1?(this.snackbar=!0,this.color="success",this.formData={},this.snackbarText=t.message):(this.snackbar=!0,this.color="error")}):(this.snackbar=!0,this.color="error",this.snackbarText="your quantities are exceeded")},getFormattedDate(e){const a=e.getFullYear(),_=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return`${a}-${_}-${t}`},getOutputstockdetails(){this.getOutputstock(this.Soid).then(e=>{this.OutputStockDetails=e.data,console.log("check output dtock",this.OutputStockDetails),this.outputStock.so_number=this.OutputStockDetails.so_number,this.outputStock.merchant_name=this.OutputStockDetails.merchant_name,this.outputStock.so_status=this.OutputStockDetails.so_status,this.outputStockproducts=this.OutputStockDetails.products})},resolveStatusVariant(e){return e.warehouse_quantity<e.ordered_quantity?{color:"success"}:{color:"error"}},deleteRow(e){const a=this.desserts.indexOf(e);a!==-1&&this.desserts.splice(a,1)},openproductdialog(){console.log("check the dialog"),this.dialog=!0},closeDialog(){this.dialog=!1},isQuantityExceeded(e,a){e!=="0"&&e>a&&(this.snackbar=!0,this.color="error",this.snackbarText="Shipped quantity cannot exceed orderd quantity.")},isQuantityExceeded2(e,a){e!=="0"&&e>a&&(this.snackbar=!0,this.color="error",this.snackbarText="Shipped quantity cannot exceed orderd quantity.")}}},M={class:"text-center"},W={class:"text-center"},j={class:"text-center"},L={class:"text-center"},Y={key:0},G={class:"text-center"},H={key:0};function J(e,a,_,t,r,i){return l(),d("div",null,[s(b,null,{default:u(()=>[s(p,{cols:"12"},{default:u(()=>[s(D,{title:"Output Stock",class:"mb-4"},{default:u(()=>[s(O,null,{default:u(()=>[s(F,{class:"mt-6"},{default:u(()=>[s(b,null,{default:u(()=>[s(p,{md:"6",cols:"12"},{default:u(()=>[s(m,{modelValue:this.outputStock.so_number,"onUpdate:modelValue":a[0]||(a[0]=o=>this.outputStock.so_number=o),label:"Sales Order",readonly:""},null,8,["modelValue"])]),_:1}),s(p,{cols:"12",md:"6"},{default:u(()=>[s(m,{modelValue:this.outputStock.merchant_name,"onUpdate:modelValue":a[1]||(a[1]=o=>this.outputStock.merchant_name=o),label:"Order From",readonly:""},null,8,["modelValue"])]),_:1}),s(p,{cols:"12",md:"6"},{default:u(()=>[s(m,{modelValue:this.outputStock.shipped_date,"onUpdate:modelValue":a[2]||(a[2]=o=>this.outputStock.shipped_date=o),type:"date",label:"Date",min:r.today},null,8,["modelValue","min"])]),_:1}),s(p,{md:"6",cols:"12"},{default:u(()=>[s(Q,{modelValue:this.outputStock.so_status,"onUpdate:modelValue":a[3]||(a[3]=o=>this.outputStock.so_status=o),label:"SO Status",items:["Acknowledged","Shipped"]},null,8,["modelValue"])]),_:1}),s(p,{cols:"12"},{default:u(()=>[s(P,{headers:r.headers,items:r.OutputStockDetails},{default:u(()=>[c("thead",null,[c("tr",null,[(l(!0),d(x,null,f(r.headers,o=>(l(),d("th",{class:"text-center",key:o},h(o.text),1))),128))])]),c("tbody",null,[(l(!0),d(x,null,f(this.outputStockproducts,(o,n)=>(l(),d("tr",{key:n},[c("td",M,h(o.exchange_quantity),1),c("td",W,h(o.ordered_quantity),1),c("td",j,[s(B,{color:i.resolveStatusVariant(o).color,class:"font-weight-medium",size:"small"},{default:u(()=>[k(h(o.warehouse_quantity),1)]),_:2},1032,["color"])]),c("td",L,[s(m,{onKeydown:i.preventDecimal,onPaste:i.preventPaste,type:"number",min:"0",max:"20000",modelValue:o.shipped_ordered,"onUpdate:modelValue":g=>o.shipped_ordered=g,outlined:"",dense:""},null,8,["onKeydown","onPaste","modelValue","onUpdate:modelValue"])]),i.isQuantityExceeded(o.shipped_ordered,o.ordered_quantity)?(l(),d("span",Y)):y("",!0),c("td",G,[s(m,{onKeydown:i.preventDecimal,onPaste:i.preventPaste,type:"number",min:"0",max:"20000",modelValue:o.shipped_exchange,"onUpdate:modelValue":g=>o.shipped_exchange=g,outlined:"",dense:""},null,8,["onKeydown","onPaste","modelValue","onUpdate:modelValue"]),i.isQuantityExceeded2(o.shipped_exchange,o.exchange_quantity)?(l(),d("span",H)):y("",!0)])]))),128))])]),_:1},8,["headers","items"])]),_:1}),s(p,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:u(()=>[s(S,{onClick:a[4]||(a[4]=o=>i.saveOutputstock())},{default:u(()=>[k("Save")]),_:1}),s(S,{color:"secondary",variant:"tonal",type:"reset"},{default:u(()=>[k(" Reset ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(R,{modelValue:r.snackbar,"onUpdate:modelValue":a[5]||(a[5]=o=>r.snackbar=o),timeout:3e3,color:r.color},{default:u(()=>[k(h(r.snackbarText),1)]),_:1},8,["modelValue","color"])])}const X=V(I,[["render",J]]),Z={components:{Outputstock:X},data(){return{currentroute:"",activeTab:"",tabs:[{title:"Create Output Stock",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=v(),this.activeTab=w(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function $(e,a,_,t,r,i){const o=T("Outputstock");return l(),d("div",null,[s(K,{modelValue:r.activeTab,"onUpdate:modelValue":a[0]||(a[0]=n=>r.activeTab=n),"show-arrows":""},{default:u(()=>[(l(!0),d(x,null,f(r.tabs,n=>(l(),C(z,{key:n.icon,value:n.tab},{default:u(()=>[s(E,{size:"20",start:"",icon:n.icon},null,8,["icon"]),k(" "+h(n.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(q),s(A,{modelValue:r.activeTab,"onUpdate:modelValue":a[1]||(a[1]=n=>r.activeTab=n),class:"mt-5 disable-tab-transition",touch:!1},{default:u(()=>[s(N,{value:"account"},{default:u(()=>[s(o)]),_:1})]),_:1},8,["modelValue"])])}const dt=V(Z,[["render",$]]);export{dt as default};
