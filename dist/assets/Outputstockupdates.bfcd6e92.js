import{_ as L,o as u,c as h,a4 as P,ac as C,g as s,w as o,k as O,l as k,i as _,j as D,a as i,b7 as G,b8 as f,F as V,q as w,t as c,b as p,f as b,m as g,u as S,b9 as F,bz as Q,bp as Y,bw as J,bx as X,bq as B,bh as Z,s as M,bi as $,v as ee,e as te,r as E}from"./index.7e5301d2.js";import{s as H}from"./Services.e2ee330a.js";import{V as q}from"./VForm.c6ad41ca.js";import{V as I}from"./VAutocomplete.8599a9d6.js";import{V as v}from"./VTextField.969f3f52.js";import{V as T}from"./VChip.af398333.js";import{V as U}from"./VTable.dc5363c0.js";import{V as se}from"./VTextarea.c141216e.js";import{V as R}from"./VDialog.6d843b05.js";import{V as ae}from"./VSelect.2e908d75.js";import{V as K}from"./VSnackbar.3334e156.js";import{V as le}from"./VPagination.c14eede1.js";import{V as oe,a as N,b as re,c as ie}from"./VWindowItem.f305b40e.js";import"./VCounter.f7f19471.js";import"./VCheckboxBtn.96ebc215.js";const ne={mixins:[H],data(){return{canAcksales:{so_id:"",not_delivered_reason:"",remarks:"",so_status:0},savingOutputStock:!1,validquan:!1,PersonRules:[e=>!!e||"Delivery Person is required"],DateRules:[e=>!!e||"Shipped date is required"],RemarkRules:[e=>!!e||"Remark is required"],Reasonrules:[e=>!!e||"Reason is required"],shippedexchange:[e=>e===0||!!e&&`${e}`.trim()!==""||"shippedexchange Quantity Is Required"],shippedquantity:[e=>e===0||!!e&&`${e}`.trim()!==""||"shipped Quantity Is Required"],snackbar:!1,snackbarText:"",timeout:6e3,color:"",top:!1,bottom:!0,left:!1,right:!1,loading3:!1,isProgress:!1,isProgress2:!1,SOID:"",SOSTATUS:"",selectedPurchaseOrder:null,dialog:!1,dialog2:!1,Soid:"",OutputStockDetails:[],filteredsalesdata:[],Salesorderdetails:[],today:this.getFormattedDate(new Date),locationdata:null,outputStock:{so_id:"",so_number:"",merchant_id:"",merchant_code:"",merchant_name:"",total_cgst:"",total_sgst:"",sub_total:"",total_margin:"",total_so_amount:"",total_quantity:"",po_number:"",created_date:"",shipped_date:this.getFormattedDate(new Date),so_status:"",products:[{merchant_product_id:"",sku_name:"",hsn_code:"",mrp:"",margin:"",ordered_quantity:"",warehouse_quantity:"",uom:"",price_per_unit:"",taxable_amount:"",cgst:"",sgst:"",amount:"",sgst_percentage:"",cgst_percentage:"",exchange:"",return:"",shipped_ordered:"",shipped_exchange:""}],delivery_user_details:[{delivery_person:"",name:""}]},outputStockproducts:[],headers2:[{text:"Brand Name",value:"brand_name"},{text:"SKU Name",value:"sku_name"},{text:"UOM",value:"uom"},{text:"Ordered Quantity",value:"quantity"},{text:"Exchange Quantity",value:"exchange_quantity"},{text:"Return",value:"return"},{text:"Available",value:"warehouse_quantity"},{text:"Shipped Ordered",value:"shipped_ordered"},{text:"Shipped Exchanged",value:"shipped_exchange"}],selectedDeliveryPerson:null,deliveryPersons:[],deliveryUserDetails:[],filtereddata:[],page:1,pageSize:10,loading2:!1,loaded:!1,loading:!1,saleshistory:[],salesdata:{},searchQuery:"",dialog:!1,cityID:"",cityLoaction:[],filterlocation:!0,Deliveryperson:[],deliverydata:[],headers:[{text:"Sales Order",value:"so_number"},{text:"Order Date",value:"created_date"},{text:"Status",value:"so_status"},{text:"Order From",value:"merchant_name"},{text:"Shipped To",value:"merchant_name"},{text:"Order Value",value:"total_so_amount"},{text:"Action",value:"actions",sortable:!1}]}},computed:{outputSalesOrders(){return this.$store.state.outputSalesOrders},totalshippedorder(){return this.Salesorderdetails.reduce((e,t)=>e+parseFloat(t.shipped_ordered||0),0)},totalshippedexchange(){return this.Salesorderdetails.reduce((e,t)=>e+parseFloat(t.shipped_exchange||0),0)},filteredOutputstocks(){return this.Salesorderdetails.filter(e=>e.exchange_quantity>0||e.quantity>0)},filteredSalesHistory(){const e=this.searchQuery.toLowerCase().trim();return this.filteredsalesdata.filter(t=>t.so_number&&t.so_number.toLowerCase().includes(e)||t.created_date&&t.created_date.toLowerCase().includes(e)||t.so_status&&t.so_status.toLowerCase().includes(e)||t.merchant_name&&t.merchant_name.toLowerCase().includes(e)||t.total_so_amount&&t.total_so_amount.toString().includes(e))},paginatedItems(){const e=(this.page-1)*this.pageSize,t=e+this.pageSize;return this.filteredSalesHistory.slice(e,t)},showNoSalesAlert(){return!this.saleshistory.some(e=>e.so_status==="Acknowledged"||e.so_status==="On Hold")}},mounted(){this.Soid=this.$route.query.so_id,this.cityID=localStorage.getItem("city_id"),this.handleBrandSelection()},created(){this.fetchOutputSalesOrders().then(()=>{this.loading=!1}).catch(e=>{console.error("Error fetching merchants:",e)})},methods:{locationdetails(){const e=localStorage.getItem("city_id"),t=this.locationdata;return this.loading=!0,new Promise((d,r)=>{this.$store.dispatch("getOutputSaleOrdersdata2",{city_id:e,location_id:t}).then(a=>{console.log("check locationdata",a),a.status==1?(this.filteredsalesdata=a.data,this.filteredsalesdata.reverse(),this.loading=!1,d(a)):(this.filteredsalesdata=[],this.loading=!1)}).catch(a=>{console.error("Error fetching output sales orders:",a),this.loading=!1,r(a)})})},handleBrandSelection(){this.getCitylocation(this.cityID).then(e=>{this.cityLoaction=e.data.data.map(t=>({value:t.location_id,text:t.location})),console.log("ceck tye res",this.cityLoaction)})},fetchOutputSalesOrders(){const e=localStorage.getItem("city_id"),t=localStorage.getItem("location_id");return new Promise((d,r)=>{e!=""&&t!==""&&(this.loading=!0,this.filterlocation=!1,this.$store.dispatch("getOutputSaleOrdersdata2",{city_id:e,location_id:t}).then(a=>{console.log("check details",a),this.filteredsalesdata=a.data,this.filteredsalesdata.reverse(),this.loading=!1,d(a)}).catch(a=>{console.error("Error fetching output sales orders:",a),this.loading=!1,r(a)}))})},validateForm2(){this.$refs.purchaseOrderForm2.validate().then(e=>{e.valid==!0?this.cancelAcksalesordersdata():(this.snackbar=!0,this.snackbarText="Please give all mandatory fields",this.color="on-background")})},cancelAcksalesordersdata(){const e={Acknowledged:0},t={so_id:this.SOID,not_delivered_reason:this.canAcksales.not_delivered_reason,remarks:this.canAcksales.remarks,so_status:e[this.SOSTATUS]};this.CancelAcksalesorders(t).then(d=>{d.data.status==1?(this.snackbar=!0,this.color="primary",this.snackbarText=d.data.message,this.dialog2=!1,window.location.reload(!0)):(this.snackbar=!0,this.color="on-background",this.snackbarText=d.data.message,this.dialog2=!1)})},validateForm(){this.$refs.purchaseOrderForm.validate().then(e=>{e.valid==!0?this.saveOutputstock():(this.snackbar=!0,this.snackbarText="Please give all mandatory fields",this.color="on-background")})},preventPaste(e){const d=(e.clipboardData||window.clipboardData).getData("text");/^[0-9]+$/.test(d)||e.preventDefault()},preventDecimal(e){(e.key==="."||e.key===","||e.key==="+"||e.key==="-"||e.keyCode===189||e.keyCode===109)&&e.preventDefault()},saveOutputstock(){const e={Draft:1,Created:2,Acknowledged:3,Shipped:4,Delivered:5},t={so_id:this.OutputStockDetails.so_id,so_number:this.outputStock.so_number,so_status:e[this.outputStock.so_status],merchant_id:this.OutputStockDetails.merchant_id,merchant_code:this.OutputStockDetails.merchant_code,merchant_name:this.outputStock.merchant_name,total_cgst:this.OutputStockDetails.total_cgst,total_sgst:this.OutputStockDetails.total_sgst,sub_total:this.OutputStockDetails.sub_total,total_margin:this.OutputStockDetails.total_margin,total_so_amount:this.OutputStockDetails.total_so_amount,total_quantity:this.OutputStockDetails.total_quantity,created_date:this.OutputStockDetails.created_date,shipped_date:this.outputStock.shipped_date,is_empty:this.outputStock.is_empty,po_number:this.outputStock.po_number,total_shipped_ordered:`${this.totalshippedorder}`,total_shipped_exchanged:`${this.totalshippedexchange}`,products:this.Salesorderdetails.map((r,a)=>({merchant_product_id:r.merchant_product_id,sku_name:r.sku_name,hsn_code:r.hsn_code,mrp:r.mrp,margin:r.margin,margin_percentage:r.margin_percentage,brand_name:r.brand_name,quantity:r.quantity,uom:r.uom,price_per_unit:r.price_per_unit,taxable_amount:r.taxable_amount,cgst:r.cgst,sgst:r.sgst,amount:r.amount,sgst_percentage:r.sgst_percentage,cgst_percentage:r.cgst_percentage,exchange:r.exchange,return:r.return,rtv_reason:r.rtv_reason,shipped_ordered:`${r.shipped_ordered}`,shipped_exchange:`${r.shipped_exchange}`})),delivery_person:this.selectedDeliveryPerson};console.log("check the post data",t);const d=this.Salesorderdetails.map(r=>(console.log("Shipped quan",r.shipped_ordered," Ordered Quan",r.quantity," Warehouse Quan",r.warehouse_quantity),this.isQuantityExceeded(r.shipped_ordered,r.quantity,r.warehouse_quantity)||this.isQuantityExceeded2(r.shipped_exchange,r.exchange,r.warehouse_quantity)));console.log("Validation Error :",d.filter(r=>r)),d.filter(r=>r).length===0?(this.loading=!0,this.savingOutputStock=!0,this.dialog=!1,this.postOutputstock(t).then(r=>{r.status==1?(this.savingOutputStock=!1,this.snackbar=!0,this.color="primary",this.formData={},this.snackbarText=r.message,this.selectedDeliveryPerson=null,this.loading=!1,this.Salesorderdetails=[],this.fetchOutputSalesOrders().then(()=>{this.loading=!1}).catch(a=>{console.error("Error fetching merchants:",a)}),this.locationdetails()):(this.savingOutputStock=!1,this.snackbar=!0,this.color="on-background",this.snackbarText="Please give proper data")})):(this.savingOutputStock=!1,this.snackbar=!0,this.color="on-background",this.snackbarText="your quantities are exceeded")},getFormattedDate(e){const t=e.getFullYear(),d=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${d}-${r}`},resolveStatusVariant2(e){return e.warehouse_quantity>=e.quantity?{color:"success"}:{color:"success"}},deleteRow(e){const t=this.desserts.indexOf(e);t!==-1&&this.desserts.splice(t,1)},openproductdialog(){this.dialog=!0},openoutputstocksforcancel(e){this.dialog2=!0,this.SOID=e.so_id,this.SOSTATUS=e.so_status},closedialogforcancel(){this.dialog2=!1},closeDialog(){this.dialog=!1},isQuantityExceeded(e,t,d){const r=Math.min(t,d);return e>r&&e!==0?(this.snackbar=!0,this.color="on-background",this.snackbarText="Shipped quantity cannot exceed ordered or warehouse quantity",!0):!1},isQuantityExceeded2(e,t,d){const r=Math.min(t,d);return e!=="0"&&e>r?(this.snackbar=!0,this.color="on-background",this.snackbarText="Shipped Exchange cannot exceed Availble quantity.",!0):!1},updatePagination(e){this.page=e},getPDFupdate(e){this.loading2=!0,window.open(e,"_blank"),this.loading2=!1},closedialog(){this.dialog=!1,this.deliveryPersons=[],this.Salesorderdetails=[],this.outputStock={}},outputstocks(e){this.dialog=!0,this.outputStock.so_number=e.so_number,this.outputStock.is_empty=e.is_empty,this.outputStock.merchant_name=e.merchant_name,this.outputStock.so_status="Shipped",this.loading3=!0,this.getOutputstock(e.so_id,this.cityID).then(t=>{this.loading3=!1,this.OutputStockDetails=t.data,this.outputStock.po_number=t.data.po_number,this.Salesorderdetails=t.data.products,this.deliveryUserDetails=t.delivery_user_details,console.log("delivery detials",this.deliveryUserDetails),this.deliveryPersons=this.deliveryUserDetails.map(d=>({value:d.delivery_person,text:d.name}))})},resolveStatusVariant(e){return e=="Acknowledged"?{color:"warning"}:{color:"error"}}}},A=e=>(J("data-v-143d277c"),e=e(),X(),e),de={style:{"max-width":"400px"}},ue={key:0,class:"loading-container"},ce={key:1,class:"loader-wrapper"},he=A(()=>i("div",{class:"loader"},null,-1)),_e=[he],me={key:2,id:"app"},pe=Y('<div id="loading-bg" data-v-143d277c><div class="loading-logo" data-v-143d277c><img src="'+B+'" height="60" width="68" alt="Logo" data-v-143d277c></div><div class="loading" data-v-143d277c><div class="effect-1 effects" data-v-143d277c></div><div class="effect-2 effects" data-v-143d277c></div><div class="effect-3 effects" data-v-143d277c></div></div></div>',1),ge=[pe],fe={key:0},ke=A(()=>i("td",{colspan:"16",class:"text-center"},[i("h1",null,"No data found !")],-1)),ye=[ke],ve={class:"text-center"},be={class:"text-center"},Se={class:"text-center"},xe={class:"text-center"},Ve={class:"text-center"},we={class:"text-center"},Oe={class:"text-center"},De={class:"text-center"},Pe={class:"text-center"},Ce={class:"text-center"},qe={class:"text-center"},Te={class:"text-center"},Ue={class:"text-center"},Fe={class:"text-center"},Ie={key:0,id:"app"},Re=A(()=>i("div",{id:"loading-bg"},[i("div",{class:"loading-logo"},[i("img",{src:B,height:"60",width:"68",alt:"Logo"})]),i("div",{class:"loading"},[i("div",{class:"effect-1 effects"}),i("div",{class:"effect-2 effects"}),i("div",{class:"effect-3 effects"})])],-1)),Le=[Re],Ae={class:"text-center"},ze={class:"text-center"},Qe={class:"text-center"},Ee={class:"text-center"},Ne={class:"text-center"},Be={class:"text-center"},Me={class:"text-center"};function He(e,t,d,r,a,n){return u(),h("div",null,[P(s(D,{class:"mb-2"},{default:o(()=>[s(O,null,{default:o(()=>[s(k,null,{default:o(()=>[s(_,{cols:"12"},{default:o(()=>[s(q,{class:"mt-6"},{default:o(()=>[s(k,null,{default:o(()=>[s(_,{md:"6",cols:"12"},{default:o(()=>[s(I,{modelValue:a.locationdata,"onUpdate:modelValue":[t[0]||(t[0]=l=>a.locationdata=l),n.locationdetails],label:"Location",items:a.cityLoaction,"item-value":"value","item-title":"text","menu-props":{maxHeight:200}},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[C,a.filterlocation]]),i("div",de,[s(v,{modelValue:a.searchQuery,"onUpdate:modelValue":t[1]||(t[1]=l=>a.searchQuery=l),class:"mb-3",density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])]),a.loading2?(u(),h("div",ue,[s(G,{height:"5",color:"primary",indeterminate:"",class:"custom-loader","full-width":""})])):f("",!0),a.savingOutputStock?(u(),h("div",ce,_e)):f("",!0),a.loading?(u(),h("div",me,ge)):f("",!0),s(U,null,{default:o(()=>[i("thead",null,[i("tr",null,[(u(!0),h(V,null,w(a.headers,l=>(u(),h("th",{key:l,class:"text-center"},c(l.text),1))),128))])]),i("tbody",null,[n.filteredSalesHistory.length===0?(u(),h("tr",fe,ye)):f("",!0),(u(!0),h(V,null,w(n.paginatedItems,l=>(u(),h("tr",{key:l.so_status},[i("td",ve,c(l.so_number),1),i("td",be,c(l.created_date),1),i("td",Se,[s(T,{color:n.resolveStatusVariant(l.so_status).color,class:"font-weight-medium",size:"small"},{default:o(()=>[p(c(l.so_status),1)]),_:2},1032,["color"])]),i("td",xe,c(l.merchant_name),1),i("td",Ve,c(l.merchant_name),1),i("td",we,c(l.total_so_amount),1),i("td",Oe,[l.so_status!="Shipped"&&l.so_status!="Delivered"?(u(),b(g,{key:0,icon:"",variant:"text",color:"success",class:"me-2",size:"small"},{default:o(()=>[s(S,{icon:"mdi-invoice-receive-outline",color:"success",size:"30",onClick:y=>n.outputstocks(l)},null,8,["onClick"])]),_:2},1024)):f("",!0),l.so_status!="Shipped"&&l.so_status!="Delivered"?(u(),b(g,{key:1,icon:"",variant:"text",color:"success",class:"me-2",size:"small"},{default:o(()=>[s(S,{icon:"material-symbols:cancel-outline",color:"error",size:"30",onClick:y=>n.openoutputstocksforcancel(l)},null,8,["onClick"])]),_:2},1024)):f("",!0),l.so_status=="Shipped"||l.so_status=="Delivered"?(u(),b(g,{key:2,icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:y=>n.getPDFupdate(l.delivery_challan_file)},{default:o(()=>[s(S,{color:"error",icon:"iwwa:file-pdf",size:"26"})]),_:2},1032,["onClick"])):f("",!0)])]))),128))])]),_:1}),a.saleshistory!=""?(u(),b(U,{key:3,headers:a.headers,items:n.paginatedItems,class:"table-rounded",height:"500","fixed-header":""},{default:o(()=>[i("thead",null,[i("tr",null,[(u(!0),h(V,null,w(a.headers,l=>(u(),h("th",{key:l,class:"text-center"},c(l.text),1))),128))])]),i("tbody",null,[i("tr",null,[i("td",De,c(e.item.so_number),1),i("td",Pe,c(e.item.created_date),1),i("td",Ce,[s(T,{color:n.resolveStatusVariant(e.item.so_status).color,class:"font-weight-medium",size:"small"},{default:o(()=>[p(c(e.item.so_status),1)]),_:1},8,["color"])]),i("td",qe,c(e.item.merchant_name),1),i("td",Te,c(e.item.merchant_name),1),i("td",Ue,c(e.item.total_so_amount),1),i("td",Fe,[e.item.so_status!="Shipped"&&e.item.so_status!="Delivered"?(u(),b(g,{key:0,icon:"",variant:"text",color:"success",class:"me-2",size:"small"},{default:o(()=>[s(S,{icon:"mdi-invoice-receive-outline",color:"success",size:"30",onClick:t[2]||(t[2]=l=>n.outputstocks(e.item))})]),_:1})):f("",!0),e.item.so_status=="Shipped"||e.item.so_status=="Delivered"?(u(),b(g,{key:1,icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:t[3]||(t[3]=l=>n.getPDFupdate(e.item.delivery_challan_file))},{default:o(()=>[s(S,{color:"error",icon:"iwwa:file-pdf",size:"26"})]),_:1})):f("",!0)])])])]),_:1},8,["headers","items"])):f("",!0),s(R,{modelValue:a.dialog2,"onUpdate:modelValue":t[6]||(t[6]=l=>a.dialog2=l),"max-width":"500"},{default:o(()=>[s(D,{title:"Cancel SO Status",class:"mb-2"},{default:o(()=>[s(O,null,{default:o(()=>[s(k,null,{default:o(()=>[s(_,{cols:"12"},{default:o(()=>[s(q,{ref:"purchaseOrderForm2",class:"mt-6"},{default:o(()=>[s(k,null,{default:o(()=>[s(_,{md:"12",cols:"12"},{default:o(()=>[s(I,{modelValue:a.canAcksales.not_delivered_reason,"onUpdate:modelValue":t[4]||(t[4]=l=>a.canAcksales.not_delivered_reason=l),items:["Revised Order","Fake Order","Duplicate","Logistics Unavailability"],label:"Reason",rules:a.Reasonrules},null,8,["modelValue","rules"])]),_:1}),s(_,{cols:"12",md:"12"},{default:o(()=>[s(se,{modelValue:a.canAcksales.remarks,"onUpdate:modelValue":t[5]||(t[5]=l=>a.canAcksales.remarks=l),"row-height":"30",rows:"4",variant:"filled","auto-grow":"",shaped:"",label:"Remark",rules:a.RemarkRules},null,8,["modelValue","rules"])]),_:1}),s(_,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:o(()=>[s(g,{onClick:n.validateForm2},{default:o(()=>[p(" Save ")]),_:1},8,["onClick"]),s(g,{onClick:n.closedialogforcancel},{default:o(()=>[p(" Close ")]),_:1},8,["onClick"]),P(s(F,{size:50,color:"primary",indeterminate:""},null,512),[[C,a.isProgress2]])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(R,{modelValue:a.dialog,"onUpdate:modelValue":t[13]||(t[13]=l=>a.dialog=l),"max-width":"1000"},{default:o(()=>[s(D,{title:"Proceed To Ship Sales Orders",class:"mb-2"},{default:o(()=>[s(O,null,{default:o(()=>[s(k,null,{default:o(()=>[s(_,{cols:"12"},{default:o(()=>[s(q,{ref:"purchaseOrderForm",class:"mt-6"},{default:o(()=>[s(k,null,{default:o(()=>[s(_,{md:"6",cols:"12"},{default:o(()=>[s(v,{modelValue:a.outputStock.so_number,"onUpdate:modelValue":t[7]||(t[7]=l=>a.outputStock.so_number=l),label:"Sales Order",readonly:""},null,8,["modelValue"])]),_:1}),s(_,{cols:"12",md:"6"},{default:o(()=>[s(v,{modelValue:a.outputStock.merchant_name,"onUpdate:modelValue":t[8]||(t[8]=l=>a.outputStock.merchant_name=l),label:"Order From",readonly:""},null,8,["modelValue"])]),_:1}),s(_,{cols:"12",md:"6"},{default:o(()=>[s(v,{modelValue:a.outputStock.shipped_date,"onUpdate:modelValue":t[9]||(t[9]=l=>a.outputStock.shipped_date=l),type:"date",label:"Date",min:a.today,rules:a.DateRules},null,8,["modelValue","min","rules"])]),_:1}),s(_,{md:"6",cols:"12"},{default:o(()=>[s(v,{modelValue:a.outputStock.so_status,"onUpdate:modelValue":t[10]||(t[10]=l=>a.outputStock.so_status=l),label:"SO Status",readonly:""},null,8,["modelValue"])]),_:1}),s(_,{md:"6",cols:"12"},{default:o(()=>[s(ae,{modelValue:a.selectedDeliveryPerson,"onUpdate:modelValue":t[11]||(t[11]=l=>a.selectedDeliveryPerson=l),label:"Select Delivery Person",items:a.deliveryPersons,"item-value":"value","item-title":"text",rules:a.PersonRules,"menu-props":{maxHeight:200}},null,8,["modelValue","items","rules"])]),_:1}),s(_,{md:"6",cols:"12"},{default:o(()=>[s(v,{modelValue:a.outputStock.po_number,"onUpdate:modelValue":t[12]||(t[12]=l=>a.outputStock.po_number=l),label:"PO Number"},null,8,["modelValue"])]),_:1}),s(_,{cols:"12"},{default:o(()=>[a.loading3?(u(),h("div",Ie,Le)):f("",!0),s(U,{headers:a.headers,items:a.Salesorderdetails},{default:o(()=>[i("thead",null,[i("tr",null,[(u(!0),h(V,null,w(a.headers2,l=>(u(),h("th",{key:l,class:"text-center"},c(l.text),1))),128))])]),i("tbody",null,[(u(!0),h(V,null,w(a.Salesorderdetails,(l,y)=>(u(),h("tr",{key:y},[i("td",Ae,c(l.brand_name),1),i("td",ze,c(l.sku_name),1),i("td",Qe,c(l.uom),1),i("td",Ee,c(l.quantity),1),i("td",Ne,c(l.exchange==""?0:l.exchange),1),i("td",Be,c(l.return),1),i("td",Me,[s(T,{color:n.resolveStatusVariant2(l).color,class:"font-weight-medium",size:"small"},{default:o(()=>[p(c(l.warehouse_quantity>=0?l.warehouse_quantity:0),1)]),_:2},1032,["color"])]),i("td",{class:Q(["text-center",{"has-error":n.isQuantityExceeded(l.shipped_ordered,l.quantity,l.warehouse_quantity)}])},[s(v,{modelValue:l.shipped_ordered,"onUpdate:modelValue":m=>l.shipped_ordered=m,type:"number",min:"0",max:"20000",rules:a.shippedquantity,outlined:"",dense:"",onKeydown:n.preventDecimal,onPaste:n.preventPaste},null,8,["modelValue","onUpdate:modelValue","rules","onKeydown","onPaste"])],2),i("td",{class:Q(["text-center",{"has-error":n.isQuantityExceeded2(l.shipped_exchange,l.exchange,l.warehouse_quantity)}])},[s(v,{modelValue:l.shipped_exchange,"onUpdate:modelValue":m=>l.shipped_exchange=m,type:"number",min:"0",max:"20000",rules:a.shippedexchange,outlined:"",dense:"",onKeydown:n.preventDecimal,onPaste:n.preventPaste},null,8,["modelValue","onUpdate:modelValue","rules","onKeydown","onPaste"])],2)]))),128))])]),_:1},8,["headers","items"])]),_:1}),s(_,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:o(()=>[s(g,{onClick:n.validateForm},{default:o(()=>[p(" Save ")]),_:1},8,["onClick"]),s(g,{onClick:n.closedialog},{default:o(()=>[p(" Close ")]),_:1},8,["onClick"]),P(s(F,{size:50,color:"primary",indeterminate:""},null,512),[[C,a.isProgress]])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(K,{modelValue:a.snackbar,"onUpdate:modelValue":t[14]||(t[14]=l=>a.snackbar=l),timeout:3e3,color:a.color},{default:o(()=>[p(c(a.snackbarText),1)]),_:1},8,["modelValue","color"]),s(le,{modelValue:a.page,"onUpdate:modelValue":t[15]||(t[15]=l=>a.page=l),length:Math.ceil(n.filteredSalesHistory.length/a.pageSize),onInput:n.updatePagination},null,8,["modelValue","length","onInput"])])}const Ke=L(ne,[["render",He],["__scopeId","data-v-143d277c"]]);const je={mixins:[H],data(){return{dialog:!1,isProgress:!1,Location:"",cityID:"",locationsdata:[],snackbar:!1,snackbarText:"",timeout:6e3,color:"",top:!1,bottom:!0,left:!1,right:!1,locationrules:[e=>!!e||"This Field is required"]}},mounted(){this.cityID=localStorage.getItem("city_id"),this.handleBrandSelection()},methods:{validateForm6(){this.$refs.purchaseOrderForm.validate().then(e=>{e.valid==!0?this.openOreport():(this.snackbar=!0,this.snackbarText="Please give all mandatory fields",this.color="on-background")})},openOreport(){this.isProgress=!0,this.getOutputstockreport(this.cityID,this.Location).then(e=>{if(e.data.status==0)this.isProgress=!1,this.snackbar=!0,this.color="on-background",this.snackbarText=e.data.message,this.dialog=!1;else{this.isProgress=!1,this.dialog=!1,this.Location="";const t="Acknowledge_Sales_Orders",d=new Date,r=d.getFullYear(),a=String(d.getMonth()+1).padStart(2,"0"),n=String(d.getDate()).padStart(2,"0"),l=String(d.getHours()).padStart(2,"0"),y=String(d.getMinutes()).padStart(2,"0"),m=`${r}${a}${n}${l}${y}`,j=`${t}_${m}.csv`,W=new Blob([e.data]),z=window.URL.createObjectURL(W),x=document.createElement("a");x.href=z,x.setAttribute("download",j),document.body.appendChild(x),x.click(),x.parentNode.removeChild(x),window.URL.revokeObjectURL(z),this.snackbar=!0,this.color="primary",this.snackbarText="Reports downloaded successfully."}}).catch(e=>{console.error("Error during report generation:",e),this.isProgress=!1,this.snackbar=!0,this.color="error",this.snackbarText="Failed to download report due to an error."})},handleBrandSelection(){this.getCitylocation(this.cityID).then(e=>{this.cityLoaction=e.data.data.map(t=>({value:t.location_id,text:t.location})),console.log("ceck tye res",this.cityLoaction)})},openMPR(){this.dialog=!0},closeMPreport(){this.dialog=!1,this.Location=""}}},We={class:"text-4xl font-weight-medium text-primary"},Ge=i("br",null,null,-1),Ye=i("img",{src:$,class:"trophy2"},null,-1);function Je(e,t,d,r,a,n){return u(),h("div",null,[s(k,null,{default:o(()=>[s(_,{cols:"12",md:"4"},{default:o(()=>[s(D,{title:"Acknowledge Sales Orders",class:"position-relative"},{default:o(()=>[s(O,null,{default:o(()=>[i("h4",We,[s(S,{size:"50",start:"",icon:"line-md:downloading-loop"})]),Ge,s(g,{size:"small",onClick:n.openMPR},{default:o(()=>[p(" Get Reports ")]),_:1},8,["onClick"])]),_:1}),s(Z,{src:e.triangleBg,class:"triangle-bg flip-in-rtl"},null,8,["src"]),Ye]),_:1})]),_:1})]),_:1}),s(R,{modelValue:a.dialog,"onUpdate:modelValue":t[1]||(t[1]=l=>a.dialog=l),"max-width":"400"},{default:o(()=>[s(D,{title:"Acknowledge Sales Orders Reports",class:"mb-2"},{default:o(()=>[s(O,null,{default:o(()=>[s(k,null,{default:o(()=>[s(_,{cols:"12"},{default:o(()=>[s(q,{ref:"purchaseOrderForm",class:"mt-6"},{default:o(()=>[s(k,null,{default:o(()=>[s(_,{cols:"12"},{default:o(()=>[s(I,{modelValue:a.Location,"onUpdate:modelValue":t[0]||(t[0]=l=>a.Location=l),label:"Location Details",items:e.cityLoaction,"item-value":"value","item-title":"text",rules:a.locationrules,"menu-props":{maxHeight:200}},null,8,["modelValue","items","rules"])]),_:1}),s(M),s(_,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:o(()=>[s(g,{onClick:n.validateForm6},{default:o(()=>[p(" Get ")]),_:1},8,["onClick"]),s(g,{onClick:n.closeMPreport},{default:o(()=>[p(" Close ")]),_:1},8,["onClick"]),P(s(F,{size:50,color:"primary",indeterminate:""},null,512),[[C,a.isProgress]])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(K,{modelValue:a.snackbar,"onUpdate:modelValue":t[2]||(t[2]=l=>a.snackbar=l),timeout:3500,color:a.color},{default:o(()=>[p(c(a.snackbarText),1)]),_:1},8,["modelValue","color"])])}const Xe=L(je,[["render",Je]]),Ze={components:{Outputstockupdate:Ke,Outputstockreport:Xe},data(){return{currentroute:"",activeTab:"",tabs:[{title:"Acknowledged Sales Orders",icon:"mdi-account-outline",tab:"account"},{title:"Acknowledged Sales Orders Report",icon:"teenyicons:attachment-outline",tab:"attach"}]}},mounted(){this.currentroute=ee(),this.activeTab=te(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function $e(e,t,d,r,a,n){const l=E("Outputstockupdate"),y=E("Outputstockreport");return u(),h("div",null,[s(oe,{modelValue:a.activeTab,"onUpdate:modelValue":t[0]||(t[0]=m=>a.activeTab=m),"show-arrows":""},{default:o(()=>[(u(!0),h(V,null,w(a.tabs,m=>(u(),b(ie,{key:m.icon,value:m.tab},{default:o(()=>[s(S,{size:"20",start:"",icon:m.icon},null,8,["icon"]),p(" "+c(m.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(M),s(re,{modelValue:a.activeTab,"onUpdate:modelValue":t[1]||(t[1]=m=>a.activeTab=m),class:"mt-5 disable-tab-transition",touch:!1},{default:o(()=>[s(N,{value:"account"},{default:o(()=>[s(l)]),_:1}),s(N,{value:"attach"},{default:o(()=>[s(y)]),_:1})]),_:1},8,["modelValue"])])}const pt=L(Ze,[["render",$e]]);export{pt as default};
