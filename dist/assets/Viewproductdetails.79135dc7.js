import{_ as w,o as m,c as _,g as s,b6 as g,f as P,w as r,i,j as k,k as y,b as p,l as f,a as n,F as b,q as V,t as d,m as v,u as S,bD as C,bn as T,v as B,e as z,s as M,r as U}from"./index.70f04199.js";import{s as I}from"./Services.dc8762b5.js";import{V as u}from"./VTextField.78336b74.js";import{V as D,a as q}from"./VAlert.7d155f95.js";import{V as G}from"./VChip.923130da.js";import{V as R}from"./VTable.d62879b9.js";import{V as F}from"./VPagination.00208ea2.js";import{V as N}from"./VForm.c6209a25.js";import{V as K}from"./VAutocomplete.f4aef25e.js";import{V as A}from"./VSelect.f15cf50f.js";import{V as W}from"./VDialog.19b0d0af.js";import{V as L}from"./VSnackbar.e407a846.js";import{V as O,a as Q,b as H,c as E}from"./VWindowItem.9ba1ccd4.js";import"./index.2bd8ddc8.js";import"./VCheckboxBtn.910787fc.js";const j={mixins:[I],data(){return{maxPaginationPages:5,storerules:[t=>!!t||"Store Address is required"],mrprules:[t=>!!t||"MRP is required"],namerules:[t=>!!t||"Name is required"],uomRules:[t=>!!t||"UOM is required"],pinrules:[t=>!!t||"PIN is required"],phonerules:[t=>!!t||" Mobile  is required",t=>/^[0-9]+$/.test(t)||"only number are accepted",t=>t&&t.length<=10&&t.length>=10||"Mobile must be  10 number"],snackbar:!1,snackbarText:"",timeout:6e3,color:"",top:!1,bottom:!0,left:!1,right:!1,dialog:!1,loading:!0,searchQuery:"",page:1,pageSize:10,products:[],saveProduct:{merchant_uid:"",brand_name:"",sku_name:"",uom:"",hsn_code:"",mrp:"",status:"",brand_id:"",brand_product_id:"",total_given_margin:"",sgst:"",cgst:"",pitch_from:"",final_retail_cp:"",final_ret:"",bk_profit:"",bizkingz_cp_final:"",bc_margin_amt:"",bc_margin:""},salesdata:[],BrandNames:[],selectedBrand:null,userRole:"",createdby:"",headers:[{text:"Brand Name",value:"brand_name"},{text:"SKU Name",value:"sku_name"},{text:"UOM",value:"uom"},{text:"HSN Code",value:"hsn_code"},{text:"MRP",value:"mrp"},{text:"Status",value:"status"},{text:"Total Given Margin",value:"total_given_margin"},{text:"SGST",value:"sgst"},{text:"CGST",value:"cgst"},{text:"Pitch From",value:"pitch_from"},{text:"Final Retail CP",value:"final_retail_cp"},{text:"Final Retail",value:"final_ret"},{text:"BK Profit",value:"bk_profit"},{text:"Bizking CP Final",value:"bizkingz_cp_final"},{text:"BC Margin Amount",value:"bc_margin_amt"},{text:"BC Margin",value:"bc_margin"},{text:"Action",value:"actions"}]}},computed:{filteredProducts(){const t=this.searchQuery.toLowerCase().trim();return this.products.filter(e=>e.brand_name&&e.brand_name.toLowerCase().includes(t)||e.sku_name&&e.sku_name.toLowerCase().includes(t)||e.uom&&e.uom.toLowerCase().includes(t)||e.hsn_code&&e.hsn_code.toString().includes(t)||e.mrp&&e.mrp.toString().includes(t)||e.status&&e.status.toLowerCase().includes(t)||e.total_given_margin&&e.total_given_margin.toString().includes(t)||e.sgst&&e.sgst.toLowerCase().includes(t)||e.cgst&&e.cgst.toLowerCase().includes(t)||e.pitch_from&&e.pitch_from.toLowerCase().includes(t)||e.final_retail_cp&&e.final_retail_cp.toString().includes(t)||e.final_ret&&e.final_ret.toLowerCase().includes(t)||e.bk_profit&&e.bk_profit.toString().includes(t)||e.bizkingz_cp_final&&e.bizkingz_cp_final.toString().includes(t)||e.bc_margin_amt&&e.bc_margin_amt.toString().includes(t)||e.bc_margin&&e.bc_margin.toLowerCase().includes(t))},paginatedItems(){const t=(this.page-1)*this.pageSize,e=t+this.pageSize;return this.filteredProducts.slice(t,e)}},mounted(){this.getBranddetails(),this.userRole=localStorage.getItem("userRole"),this.getProductsdata().then(()=>{this.loading=!1}).catch(t=>{console.error("Error fetching merchants:",t)})},methods:{preventPaste(t){const c=(t.clipboardData||window.clipboardData).getData("text");/^[0-9]+$/.test(c)||t.preventDefault()},preventDecimal(t){(t.key===","||t.key==="+"||t.key==="-"||t.keyCode===189||t.keyCode===109)&&t.preventDefault()},computedbcmargin(){const t=e=>/^(0|([1-9]\d*))(?:\.\d+)?%$/.test(String(e));return[e=>!!e||"BC margin is required",e=>e.startsWith("0%")?e==="0%"||"Must include a numerical value with a percentage symbol.":t(e)||"Must include a numerical value with a percentage symbol"]},updatebcmargin(t){t==="0%"||t==="0"?this.saveProduct.bc_margin="0%":t.startsWith("0%")?this.saveProduct.bc_margin="0%":this.saveProduct.bc_margin=t},computedSGST(){const t=e=>/^(0|([1-9]\d*))(?:\.\d+)?%$/.test(String(e));return[e=>!!e||"SGST is required",e=>e.startsWith("0%")?e==="0%"||"Must include a numerical value with a percentage symbol.":t(e)||"Must include a numerical value with a percentage symbol"]},updateSGST(t){t==="0%"||t==="0"?this.saveProduct.sgst="0%":t.startsWith("0%")?this.saveProduct.sgst="0%":this.saveProduct.sgst=t},computedCGST(){const t=e=>/^(0|([1-9]\d*))(?:\.\d+)?%$/.test(String(e));return[e=>!!e||"CGST is required",e=>e.startsWith("0%")?e==="0%"||"Must include a numerical value with a percentage symbol.":t(e)||"Must include a numerical value with a percentage symbol"]},updateCGST(t){t==="0%"||t==="0"?this.saveProduct.cgst="0%":t.startsWith("0%")?this.saveProduct.cgst="0%":this.saveProduct.cgst=t},computedFinalret(){const t=e=>/^(0|([1-9]\d*))(?:\.\d+)?%$/.test(String(e));return[e=>!!e||"Final Ret is required",e=>e.startsWith("0%")?e==="0%"||"Must include a numerical value with a percentage symbol.":t(e)||"Must include a numerical value with a percentage symbol"]},updateFinalret(t){t==="0%"||t==="0"?this.saveProduct.final_ret="0%":t.startsWith("0%")?this.saveProduct.final_ret="0%":this.saveProduct.final_ret=t},computedPitchRules(){const t=e=>/^(0|([1-9]\d*))(?:\.\d+)?%$/.test(String(e));return[e=>!!e||"Pitch From is required",e=>e.startsWith("0%")?e==="0%"||"Must include a numerical value with a percentage symbol.":t(e)||"Must include a numerical value with a percentage symbol"]},updatePitchfrom(t){t==="0%"||t==="0"?this.saveProduct.pitch_from="0%":t.startsWith("0%")?this.saveProduct.pitch_from="0%":this.saveProduct.pitch_from=t},computedTGMRules(){const t=e=>/^(0|([1-9]\d*))(?:\.\d+)?%$/.test(String(e));return[e=>!!e||"Total Given Margin is required",e=>e.startsWith("0%")?e==="0%"||"Must include a numerical value with a percentage symbol.":t(e)||"Must include a numerical value with a percentage symbol"]},updateTotalGivenMargin(t){t==="0%"||t==="0"?this.saveProduct.total_given_margin="0%":t.startsWith("0%")?this.saveProduct.total_given_margin="0%":this.saveProduct.total_given_margin=t},validateForm(){this.$refs.purchaseOrderForm.validate().then(t=>{t.valid==!0?this.UpdateProduct():(this.snackbar=!0,this.snackbarText="Please give all mandatory fields",this.color="on-background")})},UpdateProduct(){const t={brand_id:this.selectedBrand,brand_product_id:this.saveProduct.brand_product_id,sku_name:this.saveProduct.sku_name,uom:this.saveProduct.uom,hsn_code:this.saveProduct.hsn_code,mrp:this.saveProduct.mrp,total_given_margin:this.saveProduct.total_given_margin,bizkingz_cp_final:this.saveProduct.bizkingz_cp_final,pitch_from:this.saveProduct.pitch_from,final_ret:this.saveProduct.final_ret,final_retail_cp:this.saveProduct.final_retail_cp,bc_margin:this.saveProduct.bc_margin,bc_margin_amt:this.saveProduct.bc_margin_amt,bk_profit:this.saveProduct.bk_profit,cgst:this.saveProduct.cgst,sgst:this.saveProduct.sgst,status:this.saveProduct.status==="Active"?"1":"0"};console.log("post",t),this.updateProducts(t).then(e=>{e.data.status==1?(this.snackbarText=e.data.message,this.color="primary",this.snackbar=!0,this.dialog=!1,this.saveProduct={},this.getProductsdata()):(this.snackbarText=e.data.message,this.color="on-background",this.snackbar=!0)})},closeDialog(){this.dialog=!1},editProduct(t){console.log("check the edit",t),this.dialog=!0,this.selectedBrand=t.brand_name,this.selectedBrand=t.brand_id,this.saveProduct.brand_product_id=t.brand_product_id,this.saveProduct.sku_name=t.sku_name,this.saveProduct.uom=t.uom,this.saveProduct.hsn_code=t.hsn_code,this.saveProduct.mrp=t.mrp,this.saveProduct.status=t.status==1?"Active":"Inactive",this.saveProduct.total_given_margin=t.total_given_margin,this.saveProduct.sgst=t.sgst,this.saveProduct.cgst=t.cgst,this.saveProduct.pitch_from=t.pitch_from,this.saveProduct.final_retail_cp=t.final_retail_cp,this.saveProduct.final_ret=t.final_ret,this.saveProduct.bk_profit=t.bk_profit,this.saveProduct.bizkingz_cp_final=t.bizkingz_cp_final,this.saveProduct.bc_margin_amt=t.bc_margin_amt,this.saveProduct.bc_margin=t.bc_margin},resolveStatusVariant(t){return t==1?{color:"success"}:{color:"error"}},updatePagination(t){this.page=t},getProductsdata(){return new Promise((t,e)=>{this.getProducts().then(c=>{this.products=c.data.data,this.products.reverse(),t()}).catch(c=>{console.error("Error fetching merchants:",c),e(c)})})},getBranddetails(){this.getBrands().then(t=>{this.BrandNames=t.data,this.BrandNames=this.BrandNames.map(e=>({value:e.brand_id,text:e.brand_name})),console.log("mer",this.BrandNames)})}}},J={key:0,style:{"max-width":"400px"}},X={key:1,id:"app"},Y=C('<div id="loading-bg"><div class="loading-logo"><img src="'+T+'" height="60" width="68" alt="Logo"></div><div class="loading"><div class="effect-1 effects"></div><div class="effect-2 effects"></div><div class="effect-3 effects"></div></div></div>',1),Z=[Y],$=n("p",{class:"mb-0"}," The system is not retrieving the Purchase Histories from Purchase Orders. Please ensure that you have applied for Purchase Orders !",-1),ee={class:"text-center"},te={class:"text-center"},ae={class:"text-center"},se={class:"text-center"},re={class:"text-center"},le={class:"text-center"},oe={class:"text-center"},ne={class:"text-center"},ie={class:"text-center"},de={class:"text-center"},ue={class:"text-center"},ce={class:"text-center"},me={class:"text-center"},_e={class:"text-center"},he={class:"text-center"},ge={class:"text-center"},pe={key:0,class:"text-center"},fe={key:0},ve=n("td",{colspan:"16",class:"text-center"},[n("h1",null,"No data found !")],-1),Pe=[ve];function be(t,e,c,x,o,l){return m(),_("div",null,[this.products!=null?(m(),_("div",J,[s(u,{class:"mb-3",modelValue:o.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=a=>o.searchQuery=a),density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])])):g("",!0),o.loading?(m(),_("div",X,Z)):g("",!0),this.products==null?(m(),P(f,{key:2},{default:r(()=>[s(i,{cols:"12"},{default:r(()=>[s(k,{title:"Purchase Order View"},{default:r(()=>[s(y,null,{default:r(()=>[s(D,{color:"warning",variant:"tonal",class:"mb-4",border:"top"},{default:r(()=>[s(q,{class:"mb-1"},{default:r(()=>[p(" Are you sure you gave Purchase Orders? ")]),_:1}),$]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):g("",!0),this.products!=null?(m(),P(R,{key:3,headers:o.headers,items:l.paginatedItems,"item-key":"dessert",class:"table-rounded",height:"500","fixed-header":""},{default:r(()=>[n("thead",null,[n("tr",null,[(m(!0),_(b,null,V(o.headers,a=>(m(),_("th",{class:"text-center",key:a},d(a.text),1))),128))])]),n("tbody",null,[(m(!0),_(b,null,V(l.paginatedItems,(a,h)=>(m(),_("tr",{key:h},[n("td",ee,d(a.brand_name),1),n("td",te,d(a.sku_name),1),n("td",ae,d(a.uom),1),n("td",se,d(a.hsn_code),1),n("td",re,d(a.mrp),1),n("td",le,[s(G,{color:l.resolveStatusVariant(a.status).color,class:"font-weight-medium",size:"small"},{default:r(()=>[p(d(a.status==1?"Active":"Inactive"),1)]),_:2},1032,["color"])]),n("td",oe,d(a.total_given_margin),1),n("td",ne,d(a.sgst),1),n("td",ie,d(a.cgst),1),n("td",de,d(a.pitch_from),1),n("td",ue,d(a.final_retail_cp),1),n("td",ce,d(a.final_ret),1),n("td",me,d(a.bk_profit),1),n("td",_e,d(a.bizkingz_cp_final),1),n("td",he,d(a.bc_margin_amt),1),n("td",ge,d(a.bc_margin),1),this.userRole!="Sales Associate"&&this.userRole!="Brand Management"?(m(),_("td",pe,[s(v,{icon:"",variant:"text",color:"default",class:"mb-1 mt-2",size:"x-small",style:{"margin-left":"auto",display:"block"},onClick:ye=>l.editProduct(a)},{default:r(()=>[s(S,{icon:"ri-pencil-line",size:"22",color:"#BA8B32"})]),_:2},1032,["onClick"])])):g("",!0)]))),128)),l.filteredProducts.length===0?(m(),_("tr",fe,Pe)):g("",!0)])]),_:1},8,["headers","items"])):g("",!0),s(F,{modelValue:o.page,"onUpdate:modelValue":e[1]||(e[1]=a=>o.page=a),length:Math.ceil(l.filteredProducts.length/o.pageSize),onInput:l.updatePagination,max:o.maxPaginationPages},null,8,["modelValue","length","onInput","max"]),s(W,{modelValue:o.dialog,"onUpdate:modelValue":e[20]||(e[20]=a=>o.dialog=a),"max-width":"1000"},{default:r(()=>[s(k,{title:"Update Product",class:"mb-2"},{default:r(()=>[s(y,null,{default:r(()=>[s(f,null,{default:r(()=>[s(i,{cols:"12"},{default:r(()=>[s(N,{class:"mt-6",ref:"purchaseOrderForm"},{default:r(()=>[s(f,null,{default:r(()=>[s(i,{cols:"12",md:"6"},{default:r(()=>[s(K,{modelValue:o.selectedBrand,"onUpdate:modelValue":e[2]||(e[2]=a=>o.selectedBrand=a),label:"Brand Name",items:this.BrandNames,"item-value":"value","item-title":"text",rules:o.namerules,"menu-props":{maxHeight:200},required:""},null,8,["modelValue","items","rules"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.sku_name,"onUpdate:modelValue":e[3]||(e[3]=a=>this.saveProduct.sku_name=a),label:"SKU Name",rules:o.namerules,required:""},null,8,["modelValue","rules"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.uom,"onUpdate:modelValue":e[4]||(e[4]=a=>this.saveProduct.uom=a),label:"UOM",rules:o.uomRules,required:""},null,8,["modelValue","rules"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.hsn_code,"onUpdate:modelValue":e[5]||(e[5]=a=>this.saveProduct.hsn_code=a),min:"0",onKeydown:l.preventDecimal,onPaste:l.preventPaste,label:"HSN Code",type:"number",required:""},null,8,["modelValue","onKeydown","onPaste"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.mrp,"onUpdate:modelValue":e[6]||(e[6]=a=>this.saveProduct.mrp=a),min:"0",onKeydown:l.preventDecimal,onPaste:l.preventPaste,label:"MRP",rules:o.mrprules,required:""},null,8,["modelValue","onKeydown","onPaste","rules"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.total_given_margin,"onUpdate:modelValue":e[7]||(e[7]=a=>this.saveProduct.total_given_margin=a),rules:l.computedTGMRules(),label:"Total Given Margin",onInput:l.updateTotalGivenMargin,required:""},null,8,["modelValue","rules","onInput"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.bizkingz_cp_final,"onUpdate:modelValue":e[8]||(e[8]=a=>this.saveProduct.bizkingz_cp_final=a),min:"0",onKeydown:l.preventDecimal,onPaste:l.preventPaste,label:"Bizking CP Final"},null,8,["modelValue","onKeydown","onPaste"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.pitch_from,"onUpdate:modelValue":e[9]||(e[9]=a=>this.saveProduct.pitch_from=a),onInput:l.updatePitchfrom,rules:l.computedPitchRules(),label:"Pitch From"},null,8,["modelValue","onInput","rules"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.final_ret,"onUpdate:modelValue":e[10]||(e[10]=a=>this.saveProduct.final_ret=a),min:"0",onKeydown:l.preventDecimal,onPaste:l.preventPaste,label:"Final Retail"},null,8,["modelValue","onKeydown","onPaste"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.final_retail_cp,"onUpdate:modelValue":e[11]||(e[11]=a=>this.saveProduct.final_retail_cp=a),min:"0",onKeydown:l.preventDecimal,onPaste:l.preventPaste,label:"Final Retail CP"},null,8,["modelValue","onKeydown","onPaste"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.bc_margin,"onUpdate:modelValue":e[12]||(e[12]=a=>this.saveProduct.bc_margin=a),rules:l.computedbcmargin(),onInput:l.updatebcmargin,label:"BC margin "},null,8,["modelValue","rules","onInput"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.bc_margin_amt,"onUpdate:modelValue":e[13]||(e[13]=a=>this.saveProduct.bc_margin_amt=a),label:"BC margin Amount",min:"0",onKeydown:l.preventDecimal,onPaste:l.preventPaste},null,8,["modelValue","onKeydown","onPaste"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.bk_profit,"onUpdate:modelValue":e[14]||(e[14]=a=>this.saveProduct.bk_profit=a),min:"0",onKeydown:l.preventDecimal,onPaste:l.preventPaste,label:"BK Profit"},null,8,["modelValue","onKeydown","onPaste"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.cgst,"onUpdate:modelValue":e[15]||(e[15]=a=>this.saveProduct.cgst=a),rules:l.computedCGST(),onInput:l.updateCGST,label:"CGST"},null,8,["modelValue","rules","onInput"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(u,{modelValue:this.saveProduct.sgst,"onUpdate:modelValue":e[16]||(e[16]=a=>this.saveProduct.sgst=a),rules:l.computedSGST(),onInput:l.updateSGST,label:"SGST",required:""},null,8,["modelValue","rules","onInput"])]),_:1}),s(i,{md:"6",cols:"12"},{default:r(()=>[s(A,{modelValue:this.saveProduct.status,"onUpdate:modelValue":e[17]||(e[17]=a=>this.saveProduct.status=a),label:"Status",items:["Active","Inactive"],required:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:r(()=>[s(v,{onClick:e[18]||(e[18]=a=>l.validateForm())},{default:r(()=>[p("Save")]),_:1}),s(v,{color:"secondary",variant:"tonal",onClick:e[19]||(e[19]=a=>l.closeDialog())},{default:r(()=>[p(" Close ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(L,{modelValue:o.snackbar,"onUpdate:modelValue":e[21]||(e[21]=a=>o.snackbar=a),timeout:3500,color:o.color},{default:r(()=>[p(d(o.snackbarText),1)]),_:1},8,["modelValue","color"])])}const Ve=w(j,[["render",be]]),xe={components:{Viewproduct:Ve},data(){return{currentroute:"",activeTab:"",tabs:[{title:"View Products",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=B(),this.activeTab=z(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function ke(t,e,c,x,o,l){const a=U("Viewproduct");return m(),_("div",null,[s(O,{modelValue:o.activeTab,"onUpdate:modelValue":e[0]||(e[0]=h=>o.activeTab=h),"show-arrows":""},{default:r(()=>[(m(!0),_(b,null,V(o.tabs,h=>(m(),P(E,{key:h.icon,value:h.tab},{default:r(()=>[s(S,{size:"20",start:"",icon:h.icon},null,8,["icon"]),p(" "+d(h.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(M),s(H,{modelValue:o.activeTab,"onUpdate:modelValue":e[1]||(e[1]=h=>o.activeTab=h),class:"mt-5 disable-tab-transition",touch:!1},{default:r(()=>[s(Q,{value:"account"},{default:r(()=>[s(a)]),_:1})]),_:1},8,["modelValue"])])}const Ke=w(xe,[["render",ke]]);export{Ke as default};
