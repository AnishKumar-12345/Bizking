import{_ as V,o,c as i,g as r,b6 as p,f as m,w as n,i as y,j as w,k as x,b as f,l as k,a as l,F as g,q as v,t as h,m as I,u as b,bD as S,bn as P,v as T,e as C,s as H,r as N}from"./index.31ad2059.js";import{s as z}from"./Services.67b8878a.js";import{V as B}from"./VTextField.a039c958.js";import{V as R,a as L}from"./VAlert.425fc2a0.js";import{V as O}from"./VChip.5f576ff0.js";import{V as A}from"./VTable.3dcb99c1.js";import{V as D}from"./VPagination.c74da938.js";import{V as Q,a as U,b as E,c as F}from"./VWindowItem.ffe096d6.js";import"./index.2bd8ddc8.js";const q={mixins:[z],data(){return{searchQuery:"",page:1,pageSize:10,userRoles:"",loading:!0,purchaseHistory:[],userIds:"",createdBy:"",headers:[{text:"PO Number",value:"po_number"},{text:"Order Date",value:"created_date"},{text:"Status",value:"po_status"},{text:"Order To",value:"brand_name"},{text:"Shipped To",value:"brand_name"},{text:"Action",value:"actions"}]}},computed:{filteredPurchaseHistory(){const t=this.searchQuery.toLowerCase().trim();return this.purchaseHistory.filter(e=>{const u=e.po_number&&e.po_number.toLowerCase().includes(t)||e.created_date&&e.created_date.toLowerCase().includes(t)||e.po_status&&e.po_status.toLowerCase().includes(t)||e.brand_name&&e.brand_name.toLowerCase().includes(t),_=e.po_status==="Acknowledged"||e.po_status==="Shared"||e.po_status==="Received";return u&&_})},paginatedItems(){const t=(this.page-1)*this.pageSize,e=t+this.pageSize;return this.filteredPurchaseHistory.slice().sort((_,a)=>new Date(a.created_date)-new Date(_.created_date)).slice(t,e)}},mounted(){this.createdBy=localStorage.getItem("createdby"),this.userIds=localStorage.getItem("userId"),this.userRoles=localStorage.getItem("userRole"),this.getPurchasehistorydetails().then(()=>{this.loading=!1}).catch(t=>{console.error("Error fetching merchants:",t)})},methods:{updatePagination(t){this.page=t},inputstock(t){this.$router.push({name:"Createwarehouseinput",query:{po_id:t.po_id}})},getPurchasehistorydetails(){return new Promise((t,e)=>{this.getPurchaseorder(this.userIds,this.userRoles).then(u=>{this.purchaseHistory=u.data,this.purchaseHistory.reverse(),t()}).catch(u=>{console.error("Error fetching merchants:",u),e(u)})})},resolveStatusVariant(t){return t=="Acknowledged"?{color:"info"}:t=="Shared"?{color:"warning"}:{color:"success"}}}},M={key:0,style:{"max-width":"400px"}},W={key:1,id:"app"},Z=S('<div id="loading-bg"><div class="loading-logo"><img src="'+P+'" height="60" width="68" alt="Logo"></div><div class="loading"><div class="effect-1 effects"></div><div class="effect-2 effects"></div><div class="effect-3 effects"></div></div></div>',1),j=[Z],G=l("p",{class:"mb-0"}," The system is not retrieving the Purchase Histories from Purchase Orders. Please ensure that you have applied for Purchase Orders !",-1),K={key:0},J=l("td",{colspan:"16",class:"text-center"},[l("h1",null,"No data found !")],-1),X=[J],Y={class:"text-center"},$={class:"text-center"},ee={class:"text-center"},te={class:"text-center"},se={class:"text-center"},ae={key:0,class:"text-center"};function re(t,e,u,_,a,d){return o(),i("div",null,[this.purchaseHistory!=null?(o(),i("div",M,[r(B,{class:"mb-3",modelValue:a.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=s=>a.searchQuery=s),density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])])):p("",!0),a.loading?(o(),i("div",W,j)):p("",!0),this.purchaseHistory==null?(o(),m(k,{key:2},{default:n(()=>[r(y,{cols:"12"},{default:n(()=>[r(w,{title:"Purchase Order View"},{default:n(()=>[r(x,null,{default:n(()=>[r(R,{color:"warning",variant:"tonal",class:"mb-4",border:"top"},{default:n(()=>[r(L,{class:"mb-1"},{default:n(()=>[f(" Are you sure you gave Purchase Orders? ")]),_:1}),G]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):p("",!0),this.purchaseHistory!=null?(o(),m(A,{key:3,headers:a.headers,items:d.paginatedItems,"item-key":"dessert",class:"table-rounded",height:"500","fixed-header":""},{default:n(()=>[l("thead",null,[l("tr",null,[(o(!0),i(g,null,v(a.headers,s=>(o(),i("th",{class:"text-center",key:s},h(s.text),1))),128))])]),l("tbody",null,[d.filteredPurchaseHistory.length===0?(o(),i("tr",K,X)):p("",!0),(o(!0),i(g,null,v(d.paginatedItems,(s,c)=>(o(),i("tr",{key:c},[l("td",Y,h(s.po_number),1),l("td",$,h(s.created_date),1),l("td",ee,[r(O,{color:d.resolveStatusVariant(s.po_status).color,class:"font-weight-medium",size:"small"},{default:n(()=>[f(h(s.po_status),1)]),_:2},1032,["color"])]),l("td",te,h(s.brand_name),1),l("td",se,h(s.brand_name==s.brand_name?"Mauriya Spiritual & Naturals(BIZKINGZ)":s.brand_name),1),s.po_status!="Received"?(o(),i("td",ae,[r(I,{icon:"",variant:"text",color:"success",class:"me-2",size:"small"},{default:n(()=>[r(b,{icon:"mdi-invoice-receive-outline",color:"success",size:"30",onClick:le=>d.inputstock(s)},null,8,["onClick"])]),_:2},1024)])):p("",!0)]))),128))])]),_:1},8,["headers","items"])):p("",!0),r(D,{modelValue:a.page,"onUpdate:modelValue":e[1]||(e[1]=s=>a.page=s),length:Math.ceil(d.filteredPurchaseHistory.length/a.pageSize),onInput:d.updatePagination},null,8,["modelValue","length","onInput"])])}const oe=V(q,[["render",re]]),ne={components:{Viewpurchasehistories:oe},data(){return{currentroute:"",activeTab:"",tabs:[{title:"View Input Stocks",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=T(),this.activeTab=C(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function ie(t,e,u,_,a,d){const s=N("Viewpurchasehistories");return o(),i("div",null,[r(Q,{modelValue:a.activeTab,"onUpdate:modelValue":e[0]||(e[0]=c=>a.activeTab=c),"show-arrows":""},{default:n(()=>[(o(!0),i(g,null,v(a.tabs,c=>(o(),m(F,{key:c.icon,value:c.tab},{default:n(()=>[r(b,{size:"20",start:"",icon:c.icon},null,8,["icon"]),f(" "+h(c.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),r(H),r(E,{modelValue:a.activeTab,"onUpdate:modelValue":e[1]||(e[1]=c=>a.activeTab=c),class:"mt-5 disable-tab-transition",touch:!1},{default:n(()=>[r(U,{value:"account"},{default:n(()=>[r(s)]),_:1})]),_:1},8,["modelValue"])])}const ve=V(ne,[["render",ie]]);export{ve as default};
