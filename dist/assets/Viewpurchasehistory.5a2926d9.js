import{_ as v,o,c,g as t,bj as y,bg as h,f as m,w as r,i as x,j as w,k,b as _,l as I,a as n,F as g,q as f,t as d,m as P,u as b,v as T,e as S,s as H,r as C}from"./index.9e8238bc.js";import{s as z}from"./Services.a0afbe6c.js";import{V as R,a as B}from"./VAlert.941969da.js";import{V as O}from"./VChip.61664a67.js";import{V as A}from"./VTable.47b87660.js";import{V as D}from"./VPagination.1c6f1b80.js";import{V as N,a as U,b as j,c as q}from"./VWindowItem.c8530ca1.js";import"./index.2bd8ddc8.js";const F={mixins:[z],data(){return{page:1,pageSize:10,userRoles:"",loading:!0,purchaseHistory:[],userIds:"",createdBy:"",headers:[{text:"PO Number",value:"po_number"},{text:"Order Date",value:"created_date"},{text:"Status",value:"po_status"},{text:"Order To",value:"brand_name"},{text:"Shipped To",value:"brand_name"},{text:"Action",value:"actions"}]}},computed:{filteredPurchaseHistory(){return this.purchaseHistory.filter(e=>e.po_status==="Acknowledged"||e.po_status==="Shared"||e.po_status==="Received")},paginatedItems(){const e=(this.page-1)*this.pageSize,l=e+this.pageSize;return this.filteredPurchaseHistory.slice().sort((p,a)=>new Date(a.created_date)-new Date(p.created_date)).slice(e,l)}},mounted(){this.createdBy=localStorage.getItem("createdby"),this.userIds=localStorage.getItem("userId"),this.userRoles=localStorage.getItem("userRole"),this.getPurchasehistorydetails(),setTimeout(()=>{this.loading=!1},4e3)},methods:{updatePagination(e){this.page=e},inputstock(e){console.log("check the detials",e.po_id),this.$router.push({name:"Createwarehouseinput",query:{po_id:e.po_id}})},getPurchasehistorydetails(){this.getPurchaseorder(this.userIds,this.userRoles).then(e=>{console.log("check the view purchase order",e.data),this.purchaseHistory=e.data,this.purchaseHistory.reverse(),console.log("check the view purchase History",this.purchaseHistory)})},resolveStatusVariant(e){return e=="Acknowledged"?{color:"info"}:e=="Shared"?{color:"warning"}:{color:"success"}}}},L={key:0,class:"loading-container"},W=n("p",{class:"mb-0"}," The system is not retrieving the Purchase Histories from Purchase Orders. Please ensure that you have applied for Purchase Orders !",-1),E={class:"text-center"},M={class:"text-center"},G={class:"text-center"},J={class:"text-center"},K={class:"text-center"},Q={key:0,class:"text-center"};function X(e,l,V,p,a,u){return o(),c("div",null,[a.loading?(o(),c("div",L,[t(y,{height:"5",color:"primary",indeterminate:"",class:"custom-loader","full-width":""})])):h("",!0),this.purchaseHistory==null?(o(),m(I,{key:1},{default:r(()=>[t(x,{cols:"12"},{default:r(()=>[t(w,{title:"Purchase Order View"},{default:r(()=>[t(k,null,{default:r(()=>[t(R,{color:"warning",variant:"tonal",class:"mb-4",border:"top"},{default:r(()=>[t(B,{class:"mb-1"},{default:r(()=>[_(" Are you sure you gave Purchase Orders? ")]),_:1}),W]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):h("",!0),this.purchaseHistory!=null?(o(),m(A,{key:2,headers:a.headers,items:u.paginatedItems,"item-key":"dessert",class:"table-rounded",height:"500","fixed-header":""},{default:r(()=>[n("thead",null,[n("tr",null,[(o(!0),c(g,null,f(a.headers,s=>(o(),c("th",{class:"text-center",key:s},d(s.text),1))),128))])]),n("tbody",null,[(o(!0),c(g,null,f(u.paginatedItems,(s,i)=>(o(),c("tr",{key:i},[n("td",E,d(s.po_number),1),n("td",M,d(s.created_date),1),n("td",G,[t(O,{color:u.resolveStatusVariant(s.po_status).color,class:"font-weight-medium",size:"small"},{default:r(()=>[_(d(s.po_status),1)]),_:2},1032,["color"])]),n("td",J,d(s.brand_name),1),n("td",K,d(s.brand_name),1),s.po_status!="Received"?(o(),c("td",Q,[t(P,{icon:"",variant:"text",color:"success",class:"me-2",size:"small"},{default:r(()=>[t(b,{icon:"mdi-invoice-receive-outline",color:"success",size:"30",onClick:ee=>u.inputstock(s)},null,8,["onClick"])]),_:2},1024)])):h("",!0)]))),128))])]),_:1},8,["headers","items"])):h("",!0),t(D,{modelValue:a.page,"onUpdate:modelValue":l[0]||(l[0]=s=>a.page=s),length:Math.ceil(u.filteredPurchaseHistory.length/a.pageSize),onInput:u.updatePagination},null,8,["modelValue","length","onInput"])])}const Y=v(F,[["render",X]]),Z={components:{Viewpurchasehistories:Y},data(){return{currentroute:"",activeTab:"",tabs:[{title:"View Input Stocks",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=T(),this.activeTab=S(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function $(e,l,V,p,a,u){const s=C("Viewpurchasehistories");return o(),c("div",null,[t(N,{modelValue:a.activeTab,"onUpdate:modelValue":l[0]||(l[0]=i=>a.activeTab=i),"show-arrows":""},{default:r(()=>[(o(!0),c(g,null,f(a.tabs,i=>(o(),m(q,{key:i.icon,value:i.tab},{default:r(()=>[t(b,{size:"20",start:"",icon:i.icon},null,8,["icon"]),_(" "+d(i.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(H),t(j,{modelValue:a.activeTab,"onUpdate:modelValue":l[1]||(l[1]=i=>a.activeTab=i),class:"mt-5 disable-tab-transition",touch:!1},{default:r(()=>[t(U,{value:"account"},{default:r(()=>[t(s)]),_:1})]),_:1},8,["modelValue"])])}const ce=v(Z,[["render",$]]);export{ce as default};
