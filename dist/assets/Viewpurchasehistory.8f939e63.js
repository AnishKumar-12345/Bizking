import{_ as b,o,c as i,g as a,bg as p,bj as v,f as _,w as l,i as w,j as x,k,b as g,l as I,a as u,F as V,q as f,t as d,m as S,u as y,v as T,e as P,s as C,r as H}from"./index.932c584e.js";import{s as z}from"./Services.ed5d9645.js";import{V as R}from"./VTextField.08a83681.js";import{V as B,a as L}from"./VAlert.e3624d7e.js";import{V as O}from"./VChip.670d4bda.js";import{V as A}from"./VTable.ac4f1758.js";import{V as D}from"./VPagination.33a460d5.js";import{V as N,a as Q,b as U,c as F}from"./VWindowItem.beef0345.js";import"./index.2bd8ddc8.js";const j={mixins:[z],data(){return{searchQuery:"",page:1,pageSize:10,userRoles:"",loading:!0,purchaseHistory:[],userIds:"",createdBy:"",headers:[{text:"PO Number",value:"po_number"},{text:"Order Date",value:"created_date"},{text:"Status",value:"po_status"},{text:"Order To",value:"brand_name"},{text:"Shipped To",value:"brand_name"},{text:"Action",value:"actions"}]}},computed:{filteredPurchaseHistory(){const t=this.searchQuery.toLowerCase().trim();return this.purchaseHistory.filter(e=>{const m=e.po_number&&e.po_number.toLowerCase().includes(t)||e.created_date&&e.created_date.toLowerCase().includes(t)||e.po_status&&e.po_status.toLowerCase().includes(t)||e.brand_name&&e.brand_name.toLowerCase().includes(t),h=e.po_status==="Acknowledged"||e.po_status==="Shared"||e.po_status==="Received";return m&&h})},paginatedItems(){const t=(this.page-1)*this.pageSize,e=t+this.pageSize;return this.filteredPurchaseHistory.slice().sort((h,r)=>new Date(r.created_date)-new Date(h.created_date)).slice(t,e)}},mounted(){this.createdBy=localStorage.getItem("createdby"),this.userIds=localStorage.getItem("userId"),this.userRoles=localStorage.getItem("userRole"),this.getPurchasehistorydetails(),setTimeout(()=>{this.loading=!1},4e3)},methods:{updatePagination(t){this.page=t},inputstock(t){console.log("check the detials",t.po_id),this.$router.push({name:"Createwarehouseinput",query:{po_id:t.po_id}})},getPurchasehistorydetails(){this.getPurchaseorder(this.userIds,this.userRoles).then(t=>{console.log("check the view purchase order",t.data),this.purchaseHistory=t.data,this.purchaseHistory.reverse(),console.log("check the view purchase History",this.purchaseHistory)})},resolveStatusVariant(t){return t=="Acknowledged"?{color:"info"}:t=="Shared"?{color:"warning"}:{color:"success"}}}},q={key:0,style:{"max-width":"400px"}},W={key:1,class:"loading-container"},E=u("p",{class:"mb-0"}," The system is not retrieving the Purchase Histories from Purchase Orders. Please ensure that you have applied for Purchase Orders !",-1),M={class:"text-center"},G={class:"text-center"},J={class:"text-center"},K={class:"text-center"},X={class:"text-center"},Y={key:0,class:"text-center"};function Z(t,e,m,h,r,c){return o(),i("div",null,[this.purchaseHistory!=null?(o(),i("div",q,[a(R,{class:"mb-3",modelValue:r.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=s=>r.searchQuery=s),density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])])):p("",!0),r.loading?(o(),i("div",W,[a(v,{height:"5",color:"primary",indeterminate:"",class:"custom-loader","full-width":""})])):p("",!0),this.purchaseHistory==null?(o(),_(I,{key:2},{default:l(()=>[a(w,{cols:"12"},{default:l(()=>[a(x,{title:"Purchase Order View"},{default:l(()=>[a(k,null,{default:l(()=>[a(B,{color:"warning",variant:"tonal",class:"mb-4",border:"top"},{default:l(()=>[a(L,{class:"mb-1"},{default:l(()=>[g(" Are you sure you gave Purchase Orders? ")]),_:1}),E]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):p("",!0),this.purchaseHistory!=null?(o(),_(A,{key:3,headers:r.headers,items:c.paginatedItems,"item-key":"dessert",class:"table-rounded",height:"500","fixed-header":""},{default:l(()=>[u("thead",null,[u("tr",null,[(o(!0),i(V,null,f(r.headers,s=>(o(),i("th",{class:"text-center",key:s},d(s.text),1))),128))])]),u("tbody",null,[(o(!0),i(V,null,f(c.paginatedItems,(s,n)=>(o(),i("tr",{key:n},[u("td",M,d(s.po_number),1),u("td",G,d(s.created_date),1),u("td",J,[a(O,{color:c.resolveStatusVariant(s.po_status).color,class:"font-weight-medium",size:"small"},{default:l(()=>[g(d(s.po_status),1)]),_:2},1032,["color"])]),u("td",K,d(s.brand_name),1),u("td",X,d(s.brand_name),1),s.po_status!="Received"?(o(),i("td",Y,[a(S,{icon:"",variant:"text",color:"success",class:"me-2",size:"small"},{default:l(()=>[a(y,{icon:"mdi-invoice-receive-outline",color:"success",size:"30",onClick:se=>c.inputstock(s)},null,8,["onClick"])]),_:2},1024)])):p("",!0)]))),128))])]),_:1},8,["headers","items"])):p("",!0),a(D,{modelValue:r.page,"onUpdate:modelValue":e[1]||(e[1]=s=>r.page=s),length:Math.ceil(c.filteredPurchaseHistory.length/r.pageSize),onInput:c.updatePagination},null,8,["modelValue","length","onInput"])])}const $=b(j,[["render",Z]]),ee={components:{Viewpurchasehistories:$},data(){return{currentroute:"",activeTab:"",tabs:[{title:"View Input Stocks",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=T(),this.activeTab=P(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function te(t,e,m,h,r,c){const s=H("Viewpurchasehistories");return o(),i("div",null,[a(N,{modelValue:r.activeTab,"onUpdate:modelValue":e[0]||(e[0]=n=>r.activeTab=n),"show-arrows":""},{default:l(()=>[(o(!0),i(V,null,f(r.tabs,n=>(o(),_(F,{key:n.icon,value:n.tab},{default:l(()=>[a(y,{size:"20",start:"",icon:n.icon},null,8,["icon"]),g(" "+d(n.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),a(C),a(U,{modelValue:r.activeTab,"onUpdate:modelValue":e[1]||(e[1]=n=>r.activeTab=n),class:"mt-5 disable-tab-transition",touch:!1},{default:l(()=>[a(Q,{value:"account"},{default:l(()=>[a(s)]),_:1})]),_:1},8,["modelValue"])])}const he=b(ee,[["render",te]]);export{he as default};
