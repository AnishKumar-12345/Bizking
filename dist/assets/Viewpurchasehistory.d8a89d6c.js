import{_ as V,o,c as l,g as r,b6 as p,f as m,w as i,i as y,j as w,k as x,b as f,l as k,a as c,F as g,q as v,t as d,m as I,u as b,bD as S,bn as T,v as C,e as P,s as H,r as z}from"./index.b9236813.js";import{s as B}from"./Services.b8c43c9d.js";import{V as N}from"./VTextField.8ecb6399.js";import{V as R,a as L}from"./VAlert.ee6561d7.js";import{V as O}from"./VChip.c7cc526f.js";import{V as A}from"./VTable.8079df80.js";import{V as D}from"./VPagination.34e7e61b.js";import{V as Q,a as U,b as F,c as q}from"./VWindowItem.2277bb31.js";import"./index.2bd8ddc8.js";const M={mixins:[B],data(){return{searchQuery:"",page:1,pageSize:10,userRoles:"",loading:!0,purchaseHistory:[],userIds:"",createdBy:"",headers:[{text:"PO Number",value:"po_number"},{text:"Order Date",value:"created_date"},{text:"Status",value:"po_status"},{text:"Order To",value:"brand_name"},{text:"Shipped To",value:"brand_name"},{text:"Action",value:"actions"}]}},computed:{filteredPurchaseHistory(){const s=this.searchQuery.toLowerCase().trim();return this.purchaseHistory.filter(e=>{const _=e.po_number&&e.po_number.toLowerCase().includes(s)||e.created_date&&e.created_date.toLowerCase().includes(s)||e.po_status&&e.po_status.toLowerCase().includes(s)||e.brand_name&&e.brand_name.toLowerCase().includes(s),h=e.po_status==="Acknowledged"||e.po_status==="Shared"||e.po_status==="Received";return _&&h})},paginatedItems(){const s=(this.page-1)*this.pageSize,e=s+this.pageSize;return this.filteredPurchaseHistory.slice().sort((h,a)=>new Date(a.created_date)-new Date(h.created_date)).slice(s,e)}},mounted(){this.createdBy=localStorage.getItem("createdby"),this.userIds=localStorage.getItem("userId"),this.userRoles=localStorage.getItem("userRole"),this.getPurchasehistorydetails(),setTimeout(()=>{this.loading=!1},3e3)},methods:{updatePagination(s){this.page=s},inputstock(s){this.$router.push({name:"Createwarehouseinput",query:{po_id:s.po_id}})},getPurchasehistorydetails(){this.getPurchaseorder(this.userIds,this.userRoles).then(s=>{this.purchaseHistory=s.data,this.purchaseHistory.reverse(),console.log("check the view purchase History",this.purchaseHistory)})},resolveStatusVariant(s){return s=="Acknowledged"?{color:"info"}:s=="Shared"?{color:"warning"}:{color:"success"}}}},W={key:0,style:{"max-width":"400px"}},Z={key:1,id:"app"},j=S('<div id="loading-bg"><div class="loading-logo"><img src="'+T+'" height="60" width="68" alt="Logo"></div><div class="loading"><div class="effect-1 effects"></div><div class="effect-2 effects"></div><div class="effect-3 effects"></div></div></div>',1),E=[j],G=c("p",{class:"mb-0"}," The system is not retrieving the Purchase Histories from Purchase Orders. Please ensure that you have applied for Purchase Orders !",-1),K={class:"text-center"},J={class:"text-center"},X={class:"text-center"},Y={class:"text-center"},$={class:"text-center"},ee={key:0,class:"text-center"};function te(s,e,_,h,a,u){return o(),l("div",null,[this.purchaseHistory!=null?(o(),l("div",W,[r(N,{class:"mb-3",modelValue:a.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=t=>a.searchQuery=t),density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])])):p("",!0),a.loading?(o(),l("div",Z,E)):p("",!0),this.purchaseHistory==null?(o(),m(k,{key:2},{default:i(()=>[r(y,{cols:"12"},{default:i(()=>[r(w,{title:"Purchase Order View"},{default:i(()=>[r(x,null,{default:i(()=>[r(R,{color:"warning",variant:"tonal",class:"mb-4",border:"top"},{default:i(()=>[r(L,{class:"mb-1"},{default:i(()=>[f(" Are you sure you gave Purchase Orders? ")]),_:1}),G]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):p("",!0),this.purchaseHistory!=null?(o(),m(A,{key:3,headers:a.headers,items:u.paginatedItems,"item-key":"dessert",class:"table-rounded",height:"500","fixed-header":""},{default:i(()=>[c("thead",null,[c("tr",null,[(o(!0),l(g,null,v(a.headers,t=>(o(),l("th",{class:"text-center",key:t},d(t.text),1))),128))])]),c("tbody",null,[(o(!0),l(g,null,v(u.paginatedItems,(t,n)=>(o(),l("tr",{key:n},[c("td",K,d(t.po_number),1),c("td",J,d(t.created_date),1),c("td",X,[r(O,{color:u.resolveStatusVariant(t.po_status).color,class:"font-weight-medium",size:"small"},{default:i(()=>[f(d(t.po_status),1)]),_:2},1032,["color"])]),c("td",Y,d(t.brand_name),1),c("td",$,d(t.brand_name==t.brand_name?"Mauriya Spiritual & Naturals(BIZKINGZ)":t.brand_name),1),t.po_status!="Received"?(o(),l("td",ee,[r(I,{icon:"",variant:"text",color:"success",class:"me-2",size:"small"},{default:i(()=>[r(b,{icon:"mdi-invoice-receive-outline",color:"success",size:"30",onClick:oe=>u.inputstock(t)},null,8,["onClick"])]),_:2},1024)])):p("",!0)]))),128))])]),_:1},8,["headers","items"])):p("",!0),r(D,{modelValue:a.page,"onUpdate:modelValue":e[1]||(e[1]=t=>a.page=t),length:Math.ceil(u.filteredPurchaseHistory.length/a.pageSize),onInput:u.updatePagination},null,8,["modelValue","length","onInput"])])}const se=V(M,[["render",te]]),ae={components:{Viewpurchasehistories:se},data(){return{currentroute:"",activeTab:"",tabs:[{title:"View Input Stocks",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=C(),this.activeTab=P(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function re(s,e,_,h,a,u){const t=z("Viewpurchasehistories");return o(),l("div",null,[r(Q,{modelValue:a.activeTab,"onUpdate:modelValue":e[0]||(e[0]=n=>a.activeTab=n),"show-arrows":""},{default:i(()=>[(o(!0),l(g,null,v(a.tabs,n=>(o(),m(q,{key:n.icon,value:n.tab},{default:i(()=>[r(b,{size:"20",start:"",icon:n.icon},null,8,["icon"]),f(" "+d(n.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),r(H),r(F,{modelValue:a.activeTab,"onUpdate:modelValue":e[1]||(e[1]=n=>a.activeTab=n),class:"mt-5 disable-tab-transition",touch:!1},{default:i(()=>[r(U,{value:"account"},{default:i(()=>[r(t)]),_:1})]),_:1},8,["modelValue"])])}const me=V(ae,[["render",re]]);export{me as default};
