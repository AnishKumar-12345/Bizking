import{_ as x,o,c,g as a,b6 as _,b5 as S,f as h,w as r,i as w,j as k,k as C,b as g,l as T,a as i,F as y,q as V,t as u,m,u as v,bA as D,bk as z,v as I,e as P,s as A,r as L}from"./index.dc6d2f7d.js";import{s as N}from"./Services.987bac00.js";import{V as F}from"./VTextField.793ac199.js";import{V as O,a as B}from"./VAlert.fef88ac4.js";import{V as Q}from"./VChip.1bcea135.js";import{V as H}from"./VTable.8a65c88e.js";import{V as R}from"./VPagination.1167edb3.js";import{V as U,a as q,b as W,c as j}from"./VWindowItem.f3ad2692.js";import"./index.2bd8ddc8.js";const E={mixins:[N],data(){return{page:1,pageSize:10,loading2:!1,loaded:!1,loading:!0,saleshistory:[],searchQuery:"",headers:[{text:"Sales Order",value:"so_number"},{text:"Order Date",value:"created_date"},{text:"Status",value:"so_status"},{text:"Delivery Person",value:"delivery_person"},{text:"Order From",value:"merchant_name"},{text:"Shipped To",value:"merchant_name"},{text:"Order Value",value:"total_so_amount"},{text:"Delivery Challan",value:"delivery_challan_file"},{text:"Invoice",value:"invoice_file"}]}},computed:{filteredSalesHistory(){const e=this.searchQuery.toLowerCase().trim();return this.saleshistory.filter(t=>{const p=t.so_number&&t.so_number.toLowerCase().includes(e)||t.created_date&&t.created_date.toLowerCase().includes(e)||t.so_status&&t.so_status.toLowerCase().includes(e)||t.merchant_name&&t.merchant_name.toLowerCase().includes(e)||t.total_so_amount&&t.total_so_amount.toString().includes(e)||t.delivery_person&&t.delivery_person.toLowerCase().includes(e),f=t.so_status==="Delivered"||t.so_status==="Received"||t.so_status==="Shipped";return p&&f})},paginatedItems(){const e=(this.page-1)*this.pageSize,t=e+this.pageSize;return this.filteredSalesHistory.slice(e,t)},showNoSalesAlert(){return!this.saleshistory.some(e=>e.so_status==="Delivered"||e.so_status==="Received"||e.so_status==="Shipped")}},mounted(){this.getSalesorderdetails(),setTimeout(()=>{this.loading=!1},5e3)},methods:{updatePagination(e){this.page=e},getPDFinvoice(e){this.loading2=!0,window.open(e,"_blank"),this.loading2=!1},getPDFupdate(e){this.loading2=!0,window.open(e,"_blank"),this.loading2=!1},outputstock(e){this.$router.push({name:"Createwarehouseoutput",query:{so_id:e.so_id}})},resolveStatusVariant(e){return e=="Acknowledged"?{color:"warning"}:{color:"success"}},getSalesorderdetails(){this.getSalesorders().then(e=>{this.saleshistory=e.data,this.saleshistory.reverse(),console.log("check rhe res",this.saleshistory)})}}},M={key:0,style:{"max-width":"400px"}},G={key:1,class:"loading-container"},J=i("p",{class:"mb-0"}," The system is not retrieving the Sales Orders. Please ensure that you have applied for Sales Orders !",-1),K={key:3,id:"app"},X=D('<div id="loading-bg"><div class="loading-logo"><img src="'+z+'" height="60" width="68" alt="Logo"></div><div class="loading"><div class="effect-1 effects"></div><div class="effect-2 effects"></div><div class="effect-3 effects"></div></div></div>',1),Y=[X],Z={class:"text-center"},$={class:"text-center"},ee={class:"text-center"},te={class:"text-center"},se={class:"text-center"},ae={class:"text-center"},oe={class:"text-center"},le={class:"text-center"},re={class:"text-center"},ie={class:"text-center"};function ne(e,t,p,f,l,n){return o(),c("div",null,[n.showNoSalesAlert?_("",!0):(o(),c("div",M,[a(F,{class:"mb-3",modelValue:l.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=s=>l.searchQuery=s),density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])])),l.loading2?(o(),c("div",G,[a(S,{height:"5",color:"primary",indeterminate:"",class:"custom-loader","full-width":""})])):_("",!0),n.showNoSalesAlert?(o(),h(T,{key:2},{default:r(()=>[a(w,{cols:"12"},{default:r(()=>[a(k,{title:"Sales Order View"},{default:r(()=>[a(C,null,{default:r(()=>[a(O,{color:"warning",variant:"tonal",class:"mb-4",border:"top"},{default:r(()=>[a(B,{class:"mb-1"},{default:r(()=>[g(" Are you sure you gave Sales Orders? ")]),_:1}),J]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):_("",!0),l.loading?(o(),c("div",K,Y)):_("",!0),n.showNoSalesAlert?_("",!0):(o(),h(H,{key:4,headers:l.headers,items:n.paginatedItems,class:"table-rounded",height:"500","fixed-header":""},{default:r(()=>[i("thead",null,[i("tr",null,[(o(!0),c(y,null,V(l.headers,s=>(o(),c("th",{class:"text-center",key:s},u(s.text),1))),128))])]),i("tbody",null,[(o(!0),c(y,null,V(this.paginatedItems,(s,d)=>(o(),c("tr",{key:d},[i("td",Z,u(s.so_number),1),i("td",$,u(s.created_date),1),i("td",ee,[a(Q,{color:n.resolveStatusVariant(s.so_status).color,class:"font-weight-medium",size:"small"},{default:r(()=>[g(u(s.so_status),1)]),_:2},1032,["color"])]),i("td",te,u(s.delivery_person),1),i("td",se,u(s.merchant_name),1),i("td",ae,u(s.merchant_name),1),i("td",oe,u(s.total_so_amount),1),i("td",le,[s.so_status=="Shipped"||s.so_status=="Delivered"?(o(),h(m,{key:0,icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:b=>n.getPDFupdate(s.delivery_challan_file)},{default:r(()=>[a(v,{color:"error",icon:"iwwa:file-pdf",size:"26"})]),_:2},1032,["onClick"])):_("",!0)]),i("td",re,[s.so_status=="Shipped"||s.so_status=="Delivered"?(o(),h(m,{key:0,icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:b=>n.getPDFinvoice(s.invoice_file)},{default:r(()=>[a(v,{color:"error",icon:"iwwa:file-pdf",size:"26"})]),_:2},1032,["onClick"])):_("",!0)]),i("td",ie,[s.so_status!="Shipped"&&s.so_status!="Delivered"?(o(),h(m,{key:0,icon:"",variant:"text",color:"success",class:"me-2",size:"small"},{default:r(()=>[a(v,{icon:"mdi-invoice-receive-outline",color:"success",size:"30",onClick:b=>n.outputstock(s)},null,8,["onClick"])]),_:2},1024)):_("",!0)])]))),128))])]),_:1},8,["headers","items"])),a(R,{modelValue:l.page,"onUpdate:modelValue":t[1]||(t[1]=s=>l.page=s),length:Math.ceil(n.filteredSalesHistory.length/l.pageSize),onInput:n.updatePagination},null,8,["modelValue","length","onInput"])])}const de=x(E,[["render",ne]]),ce={components:{Saleshistory:de},data(){return{currentroute:"",activeTab:"",tabs:[{title:"View Sales History",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=I(),this.activeTab=P(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function ue(e,t,p,f,l,n){const s=L("Saleshistory");return o(),c("div",null,[a(U,{modelValue:l.activeTab,"onUpdate:modelValue":t[0]||(t[0]=d=>l.activeTab=d),"show-arrows":""},{default:r(()=>[(o(!0),c(y,null,V(l.tabs,d=>(o(),h(j,{key:d.icon,value:d.tab},{default:r(()=>[a(v,{size:"20",start:"",icon:d.icon},null,8,["icon"]),g(" "+u(d.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),a(A),a(W,{modelValue:l.activeTab,"onUpdate:modelValue":t[1]||(t[1]=d=>l.activeTab=d),class:"mt-5 disable-tab-transition",touch:!1},{default:r(()=>[a(q,{value:"account"},{default:r(()=>[a(s)]),_:1})]),_:1},8,["modelValue"])])}const be=x(ce,[["render",ue]]);export{be as default};
