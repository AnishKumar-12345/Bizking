import{_ as x,o,c,g as a,b6 as _,b5 as w,f as v,w as l,i as S,j as k,k as C,b as g,l as T,a as n,F as y,q as V,t as u,m,u as p,bD as D,bn as z,v as P,e as I,s as L,r as N}from"./index.81a16aa7.js";import{s as A}from"./Services.3d42a0ca.js";import{V as F}from"./VTextField.f16d975d.js";import{V as O,a as B}from"./VAlert.426d9947.js";import{V as Q}from"./VChip.75678a42.js";import{V as H}from"./VTable.be5611d2.js";import{V as R}from"./VPagination.a970c054.js";import{V as U,a as E,b as q,c as W}from"./VWindowItem.6f57b3cb.js";import"./index.2bd8ddc8.js";const j={mixins:[A],data(){return{page:1,pageSize:10,loading2:!1,loaded:!1,loading:!0,saleshistory:[],searchQuery:"",headers:[{text:"Sales Order",value:"so_number"},{text:"Order Date",value:"created_date"},{text:"Status",value:"so_status"},{text:"Delivery Person",value:"delivery_person"},{text:"Order From",value:"merchant_name"},{text:"Shipped To",value:"merchant_name"},{text:"Order Value",value:"total_so_amount"},{text:"Delivery Challan",value:"delivery_challan_file"},{text:"Invoice",value:"invoice_file"}]}},computed:{filteredSalesHistory(){const e=this.searchQuery.toLowerCase().trim();return this.saleshistory.filter(t=>{const h=t.so_number&&t.so_number.toLowerCase().includes(e)||t.created_date&&t.created_date.toLowerCase().includes(e)||t.so_status&&t.so_status.toLowerCase().includes(e)||t.merchant_name&&t.merchant_name.toLowerCase().includes(e)||t.total_so_amount&&t.total_so_amount.toString().includes(e)||t.delivery_person&&t.delivery_person.toLowerCase().includes(e),f=t.so_status==="Delivered"||t.so_status==="Received"||t.so_status==="Shipped";return h&&f})},paginatedItems(){const e=(this.page-1)*this.pageSize,t=e+this.pageSize;return this.filteredSalesHistory.slice(e,t)},showNoSalesAlert(){return!this.saleshistory.some(e=>e.so_status==="Delivered"||e.so_status==="Received"||e.so_status==="Shipped")}},mounted(){this.getSalesorderdetails().then(()=>{this.loading=!1}).catch(e=>{console.error("Error fetching merchants:",e)})},methods:{updatePagination(e){this.page=e},getPDFinvoice(e){this.loading2=!0,window.open(e,"_blank"),this.loading2=!1},getPDFupdate(e){this.loading2=!0,window.open(e,"_blank"),this.loading2=!1},outputstock(e){this.$router.push({name:"Createwarehouseoutput",query:{so_id:e.so_id}})},resolveStatusVariant(e){return e=="Acknowledged"?{color:"warning"}:{color:"success"}},getSalesorderdetails(){return new Promise((e,t)=>{this.getSalesorders().then(h=>{this.saleshistory=h.data,this.saleshistory.reverse(),e()}).catch(h=>{console.error("Error fetching merchants:",h),t(h)})})}}},M={key:0,style:{"max-width":"400px"}},G={key:1,class:"loading-container"},J=n("p",{class:"mb-0"}," The system is not retrieving the Sales Orders. Please ensure that you have applied for Sales Orders !",-1),K={key:3,id:"app"},X=D('<div id="loading-bg"><div class="loading-logo"><img src="'+z+'" height="60" width="68" alt="Logo"></div><div class="loading"><div class="effect-1 effects"></div><div class="effect-2 effects"></div><div class="effect-3 effects"></div></div></div>',1),Y=[X],Z={class:"text-center"},$={class:"text-center"},ee={class:"text-center"},te={class:"text-center"},se={class:"text-center"},ae={class:"text-center"},oe={class:"text-center"},re={class:"text-center"},le={class:"text-center"},ne={class:"text-center"};function ie(e,t,h,f,r,i){return o(),c("div",null,[i.showNoSalesAlert?_("",!0):(o(),c("div",M,[a(F,{class:"mb-3",modelValue:r.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=s=>r.searchQuery=s),density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])])),r.loading2?(o(),c("div",G,[a(w,{height:"5",color:"primary",indeterminate:"",class:"custom-loader","full-width":""})])):_("",!0),i.showNoSalesAlert?(o(),v(T,{key:2},{default:l(()=>[a(S,{cols:"12"},{default:l(()=>[a(k,{title:"Sales Order View"},{default:l(()=>[a(C,null,{default:l(()=>[a(O,{color:"warning",variant:"tonal",class:"mb-4",border:"top"},{default:l(()=>[a(B,{class:"mb-1"},{default:l(()=>[g(" Are you sure you gave Sales Orders? ")]),_:1}),J]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):_("",!0),r.loading?(o(),c("div",K,Y)):_("",!0),i.showNoSalesAlert?_("",!0):(o(),v(H,{key:4,headers:r.headers,items:i.paginatedItems,class:"table-rounded",height:"500","fixed-header":""},{default:l(()=>[n("thead",null,[n("tr",null,[(o(!0),c(y,null,V(r.headers,s=>(o(),c("th",{class:"text-center",key:s},u(s.text),1))),128))])]),n("tbody",null,[(o(!0),c(y,null,V(this.paginatedItems,(s,d)=>(o(),c("tr",{key:d},[n("td",Z,u(s.so_number),1),n("td",$,u(s.created_date),1),n("td",ee,[a(Q,{color:i.resolveStatusVariant(s.so_status).color,class:"font-weight-medium",size:"small"},{default:l(()=>[g(u(s.so_status),1)]),_:2},1032,["color"])]),n("td",te,u(s.delivery_person),1),n("td",se,u(s.merchant_name),1),n("td",ae,u(s.merchant_name),1),n("td",oe,u(s.total_so_amount),1),n("td",re,[s.so_status=="Shipped"||s.so_status=="Delivered"?(o(),v(m,{key:0,icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:b=>i.getPDFupdate(s.delivery_challan_file)},{default:l(()=>[a(p,{color:"error",icon:"iwwa:file-pdf",size:"26"})]),_:2},1032,["onClick"])):_("",!0)]),n("td",le,[s.so_status=="Shipped"||s.so_status=="Delivered"?(o(),v(m,{key:0,icon:"",variant:"text",color:"default",class:"me-2",size:"x-small",onClick:b=>i.getPDFinvoice(s.invoice_file)},{default:l(()=>[a(p,{color:"error",icon:"iwwa:file-pdf",size:"26"})]),_:2},1032,["onClick"])):_("",!0)]),n("td",ne,[s.so_status!="Shipped"&&s.so_status!="Delivered"?(o(),v(m,{key:0,icon:"",variant:"text",color:"success",class:"me-2",size:"small"},{default:l(()=>[a(p,{icon:"mdi-invoice-receive-outline",color:"success",size:"30",onClick:b=>i.outputstock(s)},null,8,["onClick"])]),_:2},1024)):_("",!0)])]))),128))])]),_:1},8,["headers","items"])),a(R,{modelValue:r.page,"onUpdate:modelValue":t[1]||(t[1]=s=>r.page=s),length:Math.ceil(i.filteredSalesHistory.length/r.pageSize),onInput:i.updatePagination},null,8,["modelValue","length","onInput"])])}const de=x(j,[["render",ie]]),ce={components:{Saleshistory:de},data(){return{currentroute:"",activeTab:"",tabs:[{title:"View Sales History",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=P(),this.activeTab=I(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function ue(e,t,h,f,r,i){const s=N("Saleshistory");return o(),c("div",null,[a(U,{modelValue:r.activeTab,"onUpdate:modelValue":t[0]||(t[0]=d=>r.activeTab=d),"show-arrows":""},{default:l(()=>[(o(!0),c(y,null,V(r.tabs,d=>(o(),v(W,{key:d.icon,value:d.tab},{default:l(()=>[a(p,{size:"20",start:"",icon:d.icon},null,8,["icon"]),g(" "+u(d.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),a(L),a(q,{modelValue:r.activeTab,"onUpdate:modelValue":t[1]||(t[1]=d=>r.activeTab=d),class:"mt-5 disable-tab-transition",touch:!1},{default:l(()=>[a(E,{value:"account"},{default:l(()=>[a(s)]),_:1})]),_:1},8,["modelValue"])])}const be=x(ce,[["render",ue]]);export{be as default};
