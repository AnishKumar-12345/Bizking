import{_ as D,r as S,o as r,c,g as s,b7 as T,b8 as g,w as n,i as p,j as w,k as L,l as y,s as P,a as o,f as U,m as v,b as h,F as f,q as k,t as d,br as N,bt as O,a4 as E,b9 as F,ac as K,bp as I,v as z,e as B,u as Q}from"./index.35f87e96.js";import{s as H}from"./Services.e0720533.js";import{V as C}from"./VForm.e7a655c5.js";import{V as R}from"./VAutocomplete.8df4ad4e.js";import{V as _}from"./VTextField.87e1f88e.js";import{V as M}from"./VTable.24a28926.js";import{V as q}from"./VPagination.af0aa810.js";import{V as j}from"./VDialog.ad7be2b3.js";import{V as A}from"./VSnackbar.2c49f97e.js";import{V as W,a as G,b as J,c as X}from"./VWindowItem.f13e0119.js";import"./VCounter.5233bcc0.js";import"./VSelect.566f1fae.js";import"./VCheckboxBtn.3849b224.js";import"./VChip.823273b5.js";const Y={mixins:[H],components:{},data(){return{dialogHeaders:[{text:"Brand Name",value:"brand_name"},{text:"SKU",value:"sku_name"},{text:"UOM",value:"uom"},{text:"Physical SOH",value:"physical_soh"},{text:"Closing",value:"closing"},{text:"Opening",value:"opening"}],editDialog:!1,editedItem:{physical_soh:null,closing:null,opening:null},loading:!0,loading2:!1,loading3:!1,searchQuery:"",page:1,pageSize:10,snackbar:!1,snackbarText:"",timeout:6e3,color:"",top:!1,bottom:!0,left:!1,right:!1,isProgress:!1,marchantstocksdata:[],editmarchantstocksdata:[],selectedmerchants:null,merchantName:[],stockUpdatedate:null,MerchantNo:null,storelevelstockid:null,closingrule:[t=>t===0||!!t&&`${t}`.trim()!==""||"Closing Is Required"],openingrule:[t=>t===0||!!t&&`${t}`.trim()!==""||"Opening Is Required"],physical_sohrule:[t=>t===0||!!t&&`${t}`.trim()!==""||"Physical soh Is Required"],headers:[{text:"Brand Name",value:"brand_name"},{text:"SKU",value:"sku_name"},{text:"UOM",value:"uom"},{text:"Physical SOH",value:"physical_soh"},{text:"Closing",value:"closing"},{text:"Opening",value:"opening"}],cityID:null,headers2:[{text:"Brand Name",value:"brand_name"},{text:"SKU",value:"sku_name"},{text:"UOM",value:"uom"},{text:"Physical SOH",value:"physical_soh"},{text:"Closing",value:"closing"},{text:"Opening",value:"opening"}]}},computed:{filterededitMerchant(){const t=this.searchQuery.toLowerCase().trim();return this.editmarchantstocksdata.filter(e=>e.brand_name&&e.brand_name.toLowerCase().includes(t)||e.sku_name&&e.sku_name.toLowerCase().includes(t)||e.uom&&e.uom.toLowerCase().includes(t)||e.physical_soh&&e.physical_soh.toLowerCase().includes(t)||e.closing&&e.closing.toLowerCase().includes(t)||e.opening&&e.opening.toLowerCase().includes(t))},paginatededitItems(){const t=(this.page-1)*this.pageSize,e=t+this.pageSize;return this.filterededitMerchant.slice(t,e)},filteredMerchant(){const t=this.searchQuery.toLowerCase().trim();return this.marchantstocksdata.filter(e=>e.brand_name&&e.brand_name.toLowerCase().includes(t)||e.sku_name&&e.sku_name.toLowerCase().includes(t)||e.uom&&e.uom.toLowerCase().includes(t)||e.physical_soh&&e.physical_soh.toLowerCase().includes(t)||e.closing&&e.closing.toLowerCase().includes(t)||e.opening&&e.opening.toLowerCase().includes(t))},paginatedItems(){const t=(this.page-1)*this.pageSize,e=t+this.pageSize;return this.filteredMerchant.slice(t,e)},merchants(){return this.merchantName.map(t=>t.merchant_uid)}},mounted(){this.cityID=localStorage.getItem("city_id"),this.getMerchantdetails().then(()=>{this.loading=!1}).catch(t=>{console.error("Error fetching merchants:",t)})},methods:{validateForm(){this.$refs.purchaseOrderForm.validate().then(t=>{t.valid==!0?this.createMerchantstock():(this.snackbar=!0,this.snackbarText="Please give all mandatory fields",this.color="on-background")})},createMerchantstock(){const t={store_level_asis_stock_id:this.storelevelstockid,merchant_id:this.MerchantNo,stock_updated_date:this.stockUpdatedate,products:this.marchantstocksdata.map(e=>({merchant_product_id:e.merchant_product_id,physical_soh:e.physical_soh.toString(),closing:e.closing.toString(),opening:e.opening.toString()}))};console.log({postData:t}),this.isProgress=!0,this.updateMerchantstock(t).then(e=>{console.log({response:e}),e.data.status==1?(this.snackbar=!0,this.color="primary",this.snackbarText=e.data.message,this.isProgress=!1,this.editDialog=!1):(this.snackbar=!0,this.isProgress=!1,this.editDialog=!0,this.color="on-background",this.snackbarText=e.data.message)})},preventDecimal(t){(t.key==="."||t.key===","||t.key==="+"||t.key==="-"||t.keyCode===189||t.keyCode===109)&&t.preventDefault()},preventPaste(t){const u=(t.clipboardData||window.clipboardData).getData("text");/^[0-9]+$/.test(u)||t.preventDefault()},openEditDialog(t){console.log("Merchant_id",t),this.editDialog=!0,this.loading3=!0,this.getMerchantproductsstock(t).then(e=>{console.log("Merchant Products:",e),e.status==1?(this.editmarchantstocksdata=e.data.products,this.loading3=!1):(this.editmarchantstocksdata=[],this.snackbar=!0,this.snackbarText=e.message,this.color="on-background")}).catch(e=>{console.error("Error fetching merchant products:",e)})},handleMerchantSelection(){const t=this.merchantName.find(e=>e.merchant_uid===this.selectedmerchants);t&&(this.selectedMerchantId=t.merchant_id,this.loading2=!0,this.getMerchantproductsstock(this.selectedMerchantId).then(e=>{console.log("Merchant Products:",e),e.status==1?(this.stockUpdatedate=e.data.stock_updated_date,this.MerchantNo=e.data.merchant_id,this.storelevelstockid=e.data.store_level_asis_stock_id,this.marchantstocksdata=e.data.products,this.loading2=!1):(this.marchantstocksdata=[],this.snackbar=!0,this.snackbarText=e.message,this.color="on-background")}).catch(e=>{console.error("Error fetching merchant products:",e)}))},closedialogs(){this.editDialog=!1,location.reload()},updatePagination(t){this.page=t},getMerchantdetails(){return new Promise((t,e)=>{this.getMerchants(this.cityID).then(u=>{this.merchantName=u.data.data,t()}).catch(u=>{console.error("Error fetching merchants:",u),e(u)})})}}},Z={key:0,class:"loading-container"},$={style:{"max-width":"400px"}},ee={key:0,id:"app"},te=o("div",{id:"loading-bg"},[o("div",{class:"loading-logo"},[o("img",{src:I,height:"60",width:"68",alt:"Logo"})]),o("div",{class:"loading"},[o("div",{class:"effect-1 effects"}),o("div",{class:"effect-2 effects"}),o("div",{class:"effect-3 effects"})])],-1),ae=[te],se={class:"d-flex justify-end mt-4"},oe={key:0},le=o("td",{colspan:"16",class:"text-center"},[o("h1",null,"No data found !")],-1),ne=[le],re={class:"text-center"},ie={class:"text-center"},ce={class:"text-center"},de={class:"text-center"},ue={class:"text-center"},he={class:"text-center"},me={key:0,id:"app"},ge=o("div",{id:"loading-bg"},[o("div",{class:"loading-logo"},[o("img",{src:I,height:"60",width:"68",alt:"Logo"})]),o("div",{class:"loading"},[o("div",{class:"effect-1 effects"}),o("div",{class:"effect-2 effects"}),o("div",{class:"effect-3 effects"})])],-1),pe=[ge],_e={class:"text-center"},fe={class:"text-center"},ke={class:"text-center"},Ve={class:"text-center"},be={class:"text-center"},ye={class:"text-center"};function ve(t,e,u,x,l,i){const V=S("VCardContent");return r(),c("div",null,[l.loading?(r(),c("div",Z,[s(T,{height:"5",color:"primary",indeterminate:"",class:"custom-loader","full-width":""})])):g("",!0),s(y,null,{default:n(()=>[s(p,{cols:"12"},{default:n(()=>[s(w,{title:"Merchants",class:"mb-4"},{default:n(()=>[s(L,null,{default:n(()=>[s(C,{class:"mt-6",ref:"purchaseOrderForm"},{default:n(()=>[s(y,null,{default:n(()=>[s(p,{md:"6",cols:"12"},{default:n(()=>[s(R,{modelValue:l.selectedmerchants,"onUpdate:modelValue":[e[0]||(e[0]=a=>l.selectedmerchants=a),i.handleMerchantSelection],label:"Store or Merchant",items:i.merchants,"menu-props":{maxHeight:200}},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),s(p,{cols:"12",md:"6"},{default:n(()=>[s(_,{modelValue:this.stockUpdatedate,"onUpdate:modelValue":e[1]||(e[1]=a=>this.stockUpdatedate=a),label:"Stock Updated Date",readonly:""},null,8,["modelValue"])]),_:1}),s(P),s(p,{cols:"12"},{default:n(()=>[o("div",$,[s(_,{class:"mb-3",modelValue:l.searchQuery,"onUpdate:modelValue":e[2]||(e[2]=a=>l.searchQuery=a),density:"compact",variant:"solo",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":""},null,8,["modelValue"])]),l.loading2?(r(),c("div",ee,ae)):g("",!0),o("div",se,[l.selectedmerchants!==null?(r(),U(v,{key:0,color:"primary",onClick:e[3]||(e[3]=a=>i.openEditDialog(this.selectedMerchantId))},{default:n(()=>[h(" Edit SOH ")]),_:1})):g("",!0)]),s(M,{headers:l.headers,items:this.paginatedItems},{default:n(()=>[o("thead",null,[o("tr",null,[(r(!0),c(f,null,k(l.headers,a=>(r(),c("th",{class:"text-center",key:a},d(a.text),1))),128))])]),o("tbody",null,[i.filteredMerchant.length===0?(r(),c("tr",oe,ne)):g("",!0),(r(!0),c(f,null,k(this.paginatedItems,(a,b)=>(r(),c("tr",{key:b},[o("td",re,d(a.brand_name),1),o("td",ie,d(a.sku_name),1),o("td",ce,d(a.uom),1),o("td",de,d(a.physical_soh),1),o("td",ue,d(a.closing),1),o("td",he,d(a.opening),1)]))),128))])]),_:1},8,["headers","items"]),s(q,{modelValue:l.page,"onUpdate:modelValue":e[4]||(e[4]=a=>l.page=a),length:Math.ceil(i.filteredMerchant.length/l.pageSize),onInput:i.updatePagination},null,8,["modelValue","length","onInput"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1}),s(j,{modelValue:l.editDialog,"onUpdate:modelValue":e[7]||(e[7]=a=>l.editDialog=a),"max-width":"800px",persistent:""},{default:n(()=>[s(w,null,{default:n(()=>[s(N,null,{default:n(()=>[h("Edit Stock Data")]),_:1}),s(V,null,{default:n(()=>[l.loading3?(r(),c("div",me,pe)):g("",!0),s(C,{class:"mt-6",ref:"purchaseOrderForm"},{default:n(()=>[s(y,null,{default:n(()=>[s(p,{cols:"12"},{default:n(()=>[s(M,{headers:l.headers,items:this.marchantstocksdata},{default:n(()=>[o("thead",null,[o("tr",null,[(r(!0),c(f,null,k(l.headers2,a=>(r(),c("th",{class:"text-center",key:a},d(a.text),1))),128))])]),o("tbody",null,[(r(!0),c(f,null,k(this.marchantstocksdata,(a,b)=>(r(),c("tr",{key:b},[o("td",_e,d(a.brand_name),1),o("td",fe,d(a.sku_name),1),o("td",ke,d(a.uom),1),o("td",Ve,[s(_,{modelValue:a.physical_soh,"onUpdate:modelValue":m=>a.physical_soh=m,onKeydown:i.preventDecimal,onPaste:i.preventPaste,type:"number",min:"0",max:"20000",outlined:"",dense:"",rules:l.physical_sohrule},null,8,["modelValue","onUpdate:modelValue","onKeydown","onPaste","rules"])]),o("td",be,[s(_,{modelValue:a.closing,"onUpdate:modelValue":m=>a.closing=m,onKeydown:i.preventDecimal,onPaste:i.preventPaste,type:"number",min:"0",max:"20000",outlined:"",dense:"",rules:l.closingrule},null,8,["modelValue","onUpdate:modelValue","onKeydown","onPaste","rules"])]),o("td",ye,[s(_,{modelValue:a.opening,"onUpdate:modelValue":m=>a.opening=m,onKeydown:i.preventDecimal,onPaste:i.preventPaste,outlined:"",dense:"",rules:l.openingrule},null,8,["modelValue","onUpdate:modelValue","onKeydown","onPaste","rules"])])]))),128))])]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1},512)]),_:1}),s(O,null,{default:n(()=>[s(v,{onClick:e[5]||(e[5]=a=>i.validateForm())},{default:n(()=>[h("Save")]),_:1}),s(v,{onClick:e[6]||(e[6]=a=>i.closedialogs())},{default:n(()=>[h("Close")]),_:1}),E(s(F,{size:50,color:"primary",indeterminate:""},null,512),[[K,l.isProgress]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(A,{modelValue:l.snackbar,"onUpdate:modelValue":e[8]||(e[8]=a=>l.snackbar=a),timeout:3500,color:l.color},{default:n(()=>[h(d(l.snackbarText),1)]),_:1},8,["modelValue","color"])])}const xe=D(Y,[["render",ve]]),we={components:{Viewstore:xe},data(){return{currentroute:"",activeTab:"",tabs:[{title:"View Store Stocks",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=z(),this.activeTab=B(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function Ce(t,e,u,x,l,i){const V=S("Viewstore");return r(),c("div",null,[s(W,{modelValue:l.activeTab,"onUpdate:modelValue":e[0]||(e[0]=a=>l.activeTab=a),"show-arrows":""},{default:n(()=>[(r(!0),c(f,null,k(l.tabs,a=>(r(),U(X,{key:a.icon,value:a.tab},{default:n(()=>[s(Q,{size:"20",start:"",icon:a.icon},null,8,["icon"]),h(" "+d(a.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(P),s(J,{modelValue:l.activeTab,"onUpdate:modelValue":e[1]||(e[1]=a=>l.activeTab=a),class:"mt-5 disable-tab-transition",touch:!1},{default:n(()=>[s(G,{value:"account"},{default:n(()=>[s(V)]),_:1})]),_:1},8,["modelValue"])])}const Be=D(we,[["render",Ce]]);export{Be as default};
