import{_,o as c,c as d,g as s,b7 as k,b8 as P,w as r,i as n,j as I,k as T,l as v,a4 as p,b9 as g,ac as b,m as V,b as m,t as x,v as y,e as w,F as M,q as N,s as S,r as C,f as R,u as D}from"./index.1e74d771.js";import{s as F}from"./Services.fc64c8f6.js";import{V as O}from"./VForm.71d58806.js";import{V as h}from"./VAutocomplete.619e07ce.js";import{V as U}from"./VSnackbar.77d80dca.js";import{V as q,a as B,b as G,c as z}from"./VWindowItem.e7e87b5e.js";import"./VCounter.43796278.js";import"./VSelect.5d5c13a6.js";import"./VCheckboxBtn.f0a6d4c7.js";import"./VChip.6a917441.js";import"./VTextField.885cdaf5.js";const H={mixins:[F],data(){return{snackbar:!1,snackbarText:"",timeout:6e3,color:"",top:!1,bottom:!0,left:!1,right:!1,selectedmerchants:"",merchantName:[],storeMerchant:[a=>!!a||"Merchant is required"],storeMerchant2:[a=>!!a||"Return Sales Order is required"],storeMerchant3:[a=>!!a||"Invoice Sales Order is required"],cityID:"",loading:!0,selectedReturnsales:"",returnName:[],isProgress:!1,isProgress2:!1,selectedInvoicesales:"",invoiceName:[]}},watch:{selectedmerchants(a){this.handleMerchantSelection(a),this.handleInvoiceSelection(a)}},mounted(){this.cityID=localStorage.getItem("city_id"),this.getMerchantdetails().then(()=>{this.loading=!1}).catch(a=>{console.error("Error fetching merchants:",a)})},methods:{validateForm(){this.$refs.purchaseOrderForm.validate().then(a=>{a.valid==!0?this.saveInvoiceformat():(this.snackbar=!0,this.snackbarText="Please give all mandatory fields",this.color="on-background")})},saveInvoiceformat(){const a={so_id:this.selectedReturnsales,invoices:this.selectedInvoicesales.map(e=>({invoice_number:e}))};console.log({postData:a}),this.isProgress2=!0,this.saveCreditnote(a).then(e=>{console.log({response:e}),e.data.status==1?(this.snackbar=!0,this.snackbarText=e.data.message,this.color="primary",this.isProgress2=!1,window.location.reload(!0)):(this.isProgress2=!1,this.snackbar=!0,this.snackbarText=e.data.message,this.color="on-background")})},handleInvoiceSelection(a){this.isProgress=!0,this.getinvoiceorders(a).then(e=>{console.log("check the response",e),e.data.status==1?(this.isProgress=!1,this.invoiceName=e.data.data.map(l=>({value:l.invoice_number,text:l.invoice_number}))):this.isProgress=!1})},handleMerchantSelection(a){this.isProgress=!0,this.getReturnsalesorders(a).then(e=>{e.data.status==1?(this.isProgress=!1,this.returnName=e.data.data.map(l=>({value:l.so_id,text:l.so_number}))):this.isProgress=!1})},getMerchantdetails(){return new Promise((a,e)=>{this.getMerchants(this.cityID).then(l=>{this.merchantName=l.data.data.map(u=>({value:u.merchant_id,text:u.merchant_uid})),a()}).catch(l=>{e(l)})})}}},E={key:0,class:"loading-container"};function L(a,e,l,u,t,f){return c(),d("div",null,[t.loading?(c(),d("div",E,[s(k,{height:"5",color:"primary",indeterminate:"",class:"custom-loader","full-width":""})])):P("",!0),s(v,null,{default:r(()=>[s(n,{cols:"12"},{default:r(()=>[s(I,{title:"Merchant Payment Details",class:"mb-4"},{default:r(()=>[s(T,null,{default:r(()=>[s(O,{class:"mt-6",ref:"purchaseOrderForm"},{default:r(()=>[s(v,null,{default:r(()=>[s(n,{md:"6",cols:"12"},{default:r(()=>[s(h,{modelValue:t.selectedmerchants,"onUpdate:modelValue":e[0]||(e[0]=o=>t.selectedmerchants=o),items:t.merchantName,"item-value":"value","item-title":"text",rules:t.storeMerchant,label:"Merchant","menu-props":{maxHeight:200},"no-underline":""},null,8,["modelValue","items","rules"]),p(s(g,{size:20,color:"primary",indeterminate:""},null,512),[[b,t.isProgress]])]),_:1}),s(n,{md:"6",cols:"12"},{default:r(()=>[s(h,{modelValue:t.selectedReturnsales,"onUpdate:modelValue":e[1]||(e[1]=o=>t.selectedReturnsales=o),items:t.returnName,"item-value":"value","item-title":"text",rules:t.storeMerchant2,label:"Return Sales Orders","menu-props":{maxHeight:200},"no-underline":""},null,8,["modelValue","items","rules"])]),_:1}),s(n,{md:"6",cols:"12"},{default:r(()=>[s(h,{modelValue:t.selectedInvoicesales,"onUpdate:modelValue":e[2]||(e[2]=o=>t.selectedInvoicesales=o),items:t.invoiceName,"item-value":"value","item-title":"text",rules:t.storeMerchant3,label:"Invoice Sales Orders","menu-props":{maxHeight:200},"no-underline":"",multiple:""},null,8,["modelValue","items","rules"])]),_:1}),s(n,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:r(()=>[s(V,{onClick:e[3]||(e[3]=o=>f.validateForm())},{default:r(()=>[m("Save")]),_:1}),s(V,{color:"secondary",variant:"tonal",type:"reset"},{default:r(()=>[m(" Reset ")]),_:1}),p(s(g,{size:30,color:"primary",indeterminate:""},null,512),[[b,t.isProgress2]])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1}),s(U,{modelValue:t.snackbar,"onUpdate:modelValue":e[4]||(e[4]=o=>t.snackbar=o),timeout:3500,color:t.color},{default:r(()=>[m(x(t.snackbarText),1)]),_:1},8,["modelValue","color"])])}const W=_(H,[["render",L]]),j={components:{Generatecreditnote:W},data(){return{currentroute:"",activeTab:"",tabs:[{title:"Generate Credit Note",icon:"mdi-account-outline",tab:"account"}]}},mounted(){this.currentroute=y(),this.activeTab=w(this.currentroute.params.tab),this.activeTab=this.tabs[0].tab}};function A(a,e,l,u,t,f){const o=C("Generatecreditnote");return c(),d("div",null,[s(q,{modelValue:t.activeTab,"onUpdate:modelValue":e[0]||(e[0]=i=>t.activeTab=i),"show-arrows":""},{default:r(()=>[(c(!0),d(M,null,N(t.tabs,i=>(c(),R(z,{key:i.icon,value:i.tab},{default:r(()=>[s(D,{size:"20",start:"",icon:i.icon},null,8,["icon"]),m(" "+x(i.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(S),s(G,{modelValue:t.activeTab,"onUpdate:modelValue":e[1]||(e[1]=i=>t.activeTab=i),class:"mt-5 disable-tab-transition",touch:!1},{default:r(()=>[s(B,{value:"account"},{default:r(()=>[s(o)]),_:1})]),_:1},8,["modelValue"])])}const re=_(j,[["render",A]]);export{re as default};
